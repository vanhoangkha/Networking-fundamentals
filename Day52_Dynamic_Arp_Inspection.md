# 51. DYNAMIC KIỂM TRA ARP là gì DYNAMIC Kiểm tra ARP (DAI) ? ARP REVIEW - ARP là used đến learn the Địa chỉ MAC của another Thiết bị với một known Địa chỉ IP - Ví dụ, a PC sẽ use ARP đến learn the Địa chỉ MAC của its Gateway mặc định đến communicate với external NETWORKS - Typically, it là một TWO MESSAGE EXCHANGE : ARP REQUEST và ARP REPLY GRATUITOUS ARP - A GRATUITOUS ARP MESSAGE là một ARP REPLY that là sent without receiving một ARP REQUEST - It là SENT đến the Broadcast Địa chỉ MAC - It allows other DEVICES đến learn the Địa chỉ MAC của the sending Thiết bị without having đến send ARP REQUESTS. - Some DEVICES automatically send GARP MESSAGES when một Giao diện là enabled, Địa chỉ IP là changed, Địa chỉ MAC là changed, etc. DYNAMIC Kiểm tra ARP - DAI là một Bảo mật FEATURE của SWITCHES that là used đến filter ARP MESSAGES received on *UNTRUSTED PORTS* - DAI only filters ARP MESSAGES. Non-ARP MESSAGES là NOT affected - All PORTS are *UNTRUSTED*, by Default - Typically, all PORTS connected đến other Mạng DEVICES (SWITCHES, ROUTERS) should be configured as TRUSTED, while INTERFACES connected đến END HOSTS nên remain UNTRUSTED ![image](https://github.com/psaumur/CCNA/assets/106411237/02da32ef-654c-4755-abcd-ea8230df4029) ![image](https://github.com/psaumur/CCNA/assets/106411237/29744383-746e-47be-8220-ba1a641a7a11) ![image](https://github.com/psaumur/CCNA/assets/106411237/6848c2b5-e866-4023-9ad9-c18f63aa6bb5) --- ARP POISONING (MAN trong THE MIDDLE) - Similar đến DHCP POISONING, ARP POISONING involved một ATTACKER manipulating TARGET’S ARP TABLES so TRAFFIC là sent đến the ATTACKER - To do this, the ATTACKER có thể send GRATUITOUS ARP MESSAGES using another Thiết bị’S Địa chỉ IP - Other DEVICES trong the Mạng sẽ receive the GARP và update their ARP TABLES, causing them đến send TRAFFIC đến the ATTACKER instead của the legitimate DESTINATION ![image](https://github.com/psaumur/CCNA/assets/106411237/aae80c8f-2673-4c04-a206-9b646f5c1f08) DYNAMIC Kiểm tra ARP OPERATIONS - DAI inspects the SENDER MAC và SENDER IP fields của ARP MESSAGES received trên UNTRUSTED PORTS và checks that there là một matching entry trong the DHCP Snooping BINDING TABLE - If there là một MATCH, the ARP MESSAGE là FORWARDED - If there là NO MATCH, the ARP MESSAGE là DISCARDED ![image](https://github.com/psaumur/CCNA/assets/106411237/060f3d3a-b2fd-46a1-8b3c-7a6839985c87) - DAI doesn’t inspect messages received trên TRUSTED PORTS. They là FORWARDED as normal. - ARP ACLs có thể be manually configured đến map IP ADDRESSES / MAC ADDRESSES cho DAI đến check - Useful cho HOSTS that don’t use DHCP - DAI có thể be configured đến perform more in-depth checks also - but these là optional - Like DHCP Snooping, DAI also supports RATE-LIMITING đến prevent ATTACKERS từ overwhelming the Switch với ARP MESSAGES - DHCP Snooping và DAI both require work từ the Switch’S CPU - Even if the ATTACKER’S messages là BLOCKED, they có thể OVERLOAD the Switch CPU với ARP MESSAGES --- DYNAMIC Kiểm tra ARP Cấu hình ![image](https://github.com/psaumur/CCNA/assets/106411237/4a91bd7b-626a-4d64-b69a-308d65bbdda4) ![image](https://github.com/psaumur/CCNA/assets/106411237/774765fa-4918-4cd9-bb64-57130968c359) Lệnh : `show ip arp inspection interfaces` ![image](https://github.com/psaumur/CCNA/assets/106411237/e64a568e-e5c6-442b-98f7-4fe829ff7519) DAI RATE LIMITING ![image](https://github.com/psaumur/CCNA/assets/106411237/6400e059-2c8c-4369-827d-7774fddd57eb) DAI OPTIONAL CHECKS ![image](https://github.com/psaumur/CCNA/assets/106411237/0e6b780a-16ef-466a-bfd3-8dd2cdace4ad) ![image](https://github.com/psaumur/CCNA/assets/106411237/1f109b81-9c9b-4acd-9557-0b652ba29b8d) ![image](https://github.com/psaumur/CCNA/assets/106411237/dd78740a-4f41-43aa-8ed2-3fa574acc0f9) ARP ACLs (Beyond Scope của CCNA) CREATE một ARP ACL cho SRV1 ![image](https://github.com/psaumur/CCNA/assets/106411237/cf121a75-45b2-4e2d-a35f-320e3f5491fa) AFTER APPLYING IT đến Switch 2, SRV1 là able đến send ARP REQUEST đến R1 ![image](https://github.com/psaumur/CCNA/assets/106411237/582feed0-1915-4f59-b3b9-9db37854c6e1) Lệnh: `show ip arp inspection` Shows một summary của the DAI Cấu hình và statistics ![image](https://github.com/psaumur/CCNA/assets/106411237/684e694a-5b0a-4f85-b135-b288a8c4c6ec) --- Lệnh REVIEW ![image](https://github.com/psaumur/CCNA/assets/106411237/4cb7dc28-b09d-4a98-8d43-aca2cdf6180b) 