# 19. DTP / VTP (NOT trong SYLLABUS) DTP (Dynamic Trunking Giao th·ª©c) - Giao th·ª©c that allows SWITCHES ƒë·∫øn negotiate the status c·ªßa their SWITCHPORTS, without manual C·∫•u h√¨nh, to be: - Truy c·∫≠p PORTS - Trunk PORTS - DTP l√† ENABLED b·ªüi Default tr√™n all Cisco GIAO DI·ªÜN Switch We‚Äôve been manually configuring SWITCHPORTS using : - ‚Äúswitchport mode Truy c·∫≠p‚Äù - ‚Äúswitchport mode Trunk‚Äù ``` üí° 'show interfaces <interface-id> switchport' will show you a switchport‚Äôs settings. ``` For B·∫£o m·∫≠t purposes, **manual C·∫•u h√¨nh** is recommended. DTP n√™n be disabled tr√™n ALL SWITCHPORTS ![image](https://github.com/psaumur/CCNA/assets/106411237/bf716a33-8e11-4c09-bb0b-336ba48ef26d) DYNAMIC DESIRABLE: - This MODE s·∫Ω actively try ƒë·∫øn form m·ªôt Trunk v·ªõi other Cisco SWITCHES. - Will form m·ªôt Trunk if connected ƒë·∫øn another SWITCHPORT trong the following modes: - ‚Äúswitchport mode Trunk‚Äù - ‚Äúswitchport mode dynamic desirable‚Äù - ‚Äúswitchport mode dynamic auto‚Äù HOWEVER ‚Ä¶ if the other Giao di·ªán l√† set to ‚Äústatic Truy c·∫≠p‚Äù (Truy c·∫≠p mode), it s·∫Ω NOT form m·ªôt Trunk, it s·∫Ω be m·ªôt Truy c·∫≠p C·ªïng DYNAMIC AUTO: - This MODE s·∫Ω NOT actively try ƒë·∫øn form m·ªôt Trunk v·ªõi other Cisco SWITCHES - Will form m·ªôt Trunk if connected SWTICH l√† actively trying ƒë·∫øn form m·ªôt Trunk. - It s·∫Ω form m·ªôt Trunk v·ªõi m·ªôt SWITCHPORT trong the following modes: - ‚Äúswitchport mode Trunk‚Äù - ‚Äúswitchport mode dynamic desirable‚Äù Trunk ƒë·∫øn Truy c·∫≠p connection s·∫Ω operate trong a **Mismatched Mode**. This C·∫•u h√¨nh does NOT work v√† n√™n result trong m·ªôt error. Traffic s·∫Ω NOT work. TABLE SHOWING THE DIFFERENT MODES v√† COMPATIBILITY trong FORMING m·ªôt Trunk ![image](https://github.com/psaumur/CCNA/assets/106411237/93d5e4f4-cb24-4d3f-ba62-fd002581cfbb) --- DTP s·∫Ω NOT form m·ªôt Trunk with: a Router a PC etcetera ‚Ä¶ The SWITCHPORT s·∫Ω be trong Truy c·∫≠p Mode only! OLD SWITCHES: - ‚Äúswitchport mode dynamic desirable‚Äù = Default Qu·∫£n tr·ªã mode. NEWER SWITCHES: - ‚Äúswitchport mode dynamic auto‚Äù = Default Qu·∫£n tr·ªã mode. C√°ch V√¥ hi·ªáu h√≥a DTP NEGOTIATION tr√™n m·ªôt Giao di·ªán: - ‚Äúswitchport nonegotiate‚Äù - ‚Äúswitchport mode Truy c·∫≠p‚Äù It l√† m·ªôt B·∫£o m·∫≠t recommendation ƒë·∫øn V√¥ hi·ªáu h√≥a DTP tr√™n all SWITCHPORTS v√† manually configure them as Truy c·∫≠p ho·∫∑c Trunk ports. --- ƒê√≥ng g√≥i: SWITCHES that support both: - 802.1Q - ISL Trunk ƒê√≥ng g√≥i c√≥ th·ªÉ use DTP ƒë·∫øn negotiate the ƒê√≥ng g√≥i they s·∫Ω use. - Negotiation l√† Enabled b·ªüi Default ``` üí° 'switchport trunk encapsulation negotiate' ``` - ISL l√† favored over 802.1Q - If BOTH SWITCHES support ISL, ISL s·∫Ω be selected. - DTP frames l√† sent in: - VLAN1 when using ISL - VLAN g·ªëc when using 802.1Q (the Default VLAN g·ªëc l√† VLAN1, however) --- VTP (VLAN Trunking Giao th·ª©c) In Privileged EXEC mode: ``` üí° #show vtp status ``` - Giao th·ª©c cho configuring VLANs tr√™n m·ªôt Central Switch - A SERVER that other SWITCHES synch. to (auto configuring b·ªüi connection) - Other switches (VTP CLIENTS) will synchronize their VLAN database ƒë·∫øn the SERVER - Designed cho large networks v·ªõi many VLANs (reduces manual C·∫•u h√¨nh) - RARELY used. Recommended you DO NOT USE it - There l√† THREE VTP Versions : - v1 - Does NOT supports Extended VLAN Range 1006-4094 - v2 - Does NOT supports Extended VLAN Range 1006-4094 - Supports Token Ring VLANs ; otherwise similar ƒë·∫øn V1 - v3 - Supports Extended VLAN Range 1006-4094 - CLIENTS store VLAN dBase trong NVRAM - There are **THREE VTP modes**: - SERVER - CLIENT - TRANSPARENT - Cisco SWITCHES operate trong VTP SERVER mode, by Default --- ![image](https://github.com/psaumur/CCNA/assets/106411237/87dcd7ff-f3d3-4441-841c-a0506c249f03) --- VTP SERVERS: - Can ADD / MODIFY / DELETE VLANs - Store the VLAN dBase trong NVRAM - Increase Revision Number every time VLAN l√† Added / Modified / Deleted - Advertises **Latest Version** of VLAN dBase tr√™n Trunk interfaces. - VTP CLIENTS synchronize their VLAN dBase ƒë·∫øn it - **VTP SERVERS also function as VTP CLIENTS** - **THEREFORE, a VTP SERVER s·∫Ω synchronize ƒë·∫øn another VTP SERVER v·ªõi m·ªôt higher Revision Number** <aside> üö® One danger c·ªßa VTP: Connecting m·ªôt old Switch v·ªõi higher Revision Number ƒë·∫øn M·∫°ng (and if the VTP Domain Name matches), all SWITCHES trong Domain s·∫Ω synchronize their VLAN dBase ƒë·∫øn Switch </aside> VTP CLIENTS: ``` üí° (config)# vtp mode client ``` - Cannot Add / Modify / Delete VLANs - Does NOT store the VLAN database trong NVRAM - **VTP v3 CLIENTS DO** - Will synchronize their VLAN dBase ƒë·∫øn the SERVER v·ªõi the highest version number trong their VTP Domain - Advertise their VLAN dBase v√† forward VTP Advertisements ƒë·∫øn other CLIENTS over Trunk Ports VTP TRANSPARENT MODE: ``` üí° (config)# vtp mode transparent ``` - Does NOT participate trong VTP Domain (does NOT sync VLAN database) - Maintains own VLAN dBase trong NVRAM. - Can Add / Modify / Delete VLANs - Won‚Äôt Advertise ƒë·∫øn other SWITCHES - Will forward VTP advertisements ƒë·∫øn SWITCHES trong the same Domain as it. --- VTP DOMAINS If m·ªôt Switch v·ªõi no VTP Domain (Domain NULL) receives m·ªôt VTP advertisement v·ªõi m·ªôt VTP Domain name, it s·∫Ω automatically join that VTP Domain If m·ªôt Switch receives m·ªôt VTP advertisement trong the same VTP domain v·ªõi m·ªôt higher revision number, it s·∫Ω update it‚Äôs VLAN database ƒë·∫øn match --- REVISION NUMBERS: There l√† TWO ways ƒë·∫øn RESET m·ªôt REVISION NUMBER ƒë·∫øn 0: - Change VTP Domain ƒë·∫øn m·ªôt unused Domain - Change VTP mode ƒë·∫øn TRANSPARENT --- VTP VERSION NUMBER ``` üí° (config)#vtp version <version number> ``` Changing the Version # will force sync/update all connected SWITCHES ƒë·∫øn the latest Version # 