# 23. EtherChannel l√† g√¨ EtherChannel? EtherChannel allows you ƒë·∫øn GROUP multiple physical INTERFACES into m·ªôt group which operates as m·ªôt SINGLE LOGICAL Giao di·ªán - so they BEHAVE as if they l√† m·ªôt single Giao di·ªán A LAYER 2 EtherChannel l√† m·ªôt group c·ªßa Switch PORTS which operate as m·ªôt SINGLE Giao di·ªán A LAYER 3 EtherChannel l√† m·ªôt group c·ªßa ROUTED PORTS which operate as m·ªôt SINGLE Giao di·ªán which you assign m·ªôt ƒê·ªãa ch·ªâ IP to. ![image](https://github.com/psaumur/CCNA/assets/106411237/86cecd4a-1554-4ece-8a88-6f97e24788f1) When the bandwidth c·ªßa the INTERFACES connected ƒë·∫øn END HOSTS l√† greater than the bandwidth c·ªßa the connection ƒë·∫øn the DISTRIBUTION Switch(es), this l√† called **OVERSUBSCRIPTION.** Some OVERSUBSCRIPTION l√† acceptable, but too much s·∫Ω cause congestion. ![image](https://github.com/psaumur/CCNA/assets/106411237/6ada996f-8fd4-4339-9ad7-d52e51a3553e) - If you connect TWO SWITCHES together v·ªõi multiple links, ALL except ONE s·∫Ω be DISABLED b·ªüi Spanning Tree Giao th·ª©c (Green Lights vs. Orange Lights above tr√™n ASW1) WHY? - If ALL c·ªßa ASW1s INTERFACES were FORWARDING, LAYER 2 LOOPS s·∫Ω form between ASW1 v√† DSW1, leading ƒë·∫øn m·ªôt Broadcast STORM (Bad!) - Other links s·∫Ω be unused unless the active link fails. In that case, one c·ªßa the inactive link s·∫Ω start forwarding. An EtherChannel (in M·∫°ng C·∫•u tr√∫c m·∫°ng diagrams) is represented like THIS (circle around multi-connections) ![image](https://github.com/psaumur/CCNA/assets/106411237/4c2cfcf8-57f2-4907-8322-2f26cc7dc7e4) - EtherChannel groups multiple channels together ƒë·∫øn act as m·ªôt SINGLE Giao di·ªán - STP s·∫Ω treat this GROUP as m·ªôt SINGLE Giao di·ªán ![image](https://github.com/psaumur/CCNA/assets/106411237/a48bed14-11b4-42ba-965a-9724598d3b69) (All INTERFACES Green!) TRAFFIC using EtherChannel s·∫Ω be load-balanced among the physical INTERFACES trong the group. An algorithm l√† used ƒë·∫øn determine WHICH TRAFFIC s·∫Ω use WHICH physical Giao di·ªán (more details later) Some other names cho m·ªôt EtherChannel are: - C·ªïng CHANNEL - LAG (Link Aggregation Group) --- HOW DOES m·ªôt EtherChannel LOAD-BALANCE? ![image](https://github.com/psaumur/CCNA/assets/106411237/bc257ff8-bf91-4744-a6cb-8f603ee9d294) - EtherChannel load-balances based on **‚Äúflows‚Äù** - A ‚Äúflow‚Äù is m·ªôt communication between TWO NODES trong the M·∫°ng - FRAMES trong the same ‚Äúflow‚Äù will be FORWARDED using the SAME physical Giao di·ªán - If FRAMES trong the same ‚Äúflow‚Äù were FORWARDED using different physical INTERFACES, some FRAMES c√≥ th·ªÉ arrive t·∫°i the DESTINATION out c·ªßa order/sequence, which c√≥ th·ªÉ cause problems. - You c√≥ th·ªÉ CHANGE the INPUTS used trong the Giao di·ªán SELECTION calculation (for ‚Äúflows‚Äù) - INPUTS that c√≥ th·ªÉ be used: - SOURCE ƒê·ªãa ch·ªâ MAC - DESTINATION ƒê·ªãa ch·ªâ MAC - SOURCE v√† DESTINATION ƒê·ªãa ch·ªâ MAC - SOURCE ƒê·ªãa ch·ªâ IP - DESTINATION ƒê·ªãa ch·ªâ IP - SOURCE v√† DESTINATION ƒê·ªãa ch·ªâ IP C√°ch see the C·∫•u h√¨nh cho LOAD-BALANCING method ![image](https://github.com/psaumur/CCNA/assets/106411237/571623bf-b96b-4382-ada5-f14f93ec1a6a) C√°ch CHANGE the LOAD-BALANCING method ![image](https://github.com/psaumur/CCNA/assets/106411237/5919f2fd-80bb-4b10-bfa0-ce403f52c710) ![image](https://github.com/psaumur/CCNA/assets/106411237/bc30e17e-716a-41cd-a57a-69a661b5d58e) --- C√°ch CONFIGURE LAYER 2 / LAYER 3 ETHERCHANNELS There l√† THREE methods c·ªßa EtherChannel C·∫•u h√¨nh tr√™n Cisco SWITCHES **PAgP (C·ªïng Aggregation Giao th·ª©c)** - Cisco proprietary Giao th·ª©c - Dynamically negotiates the creation/maintenance c·ªßa the EtherChannel (like DTP does cho trunks) üí° **LACP (Link Aggregation Ki·ªÉm so√°t Giao th·ª©c)** - Industry standard Giao th·ª©c (IEEE 802.3ad) - Dynamically negotiates the creation/maintenance c·ªßa the EtherChannel (like DTP does cho trunks) **Static EtherChannel** - A Giao th·ª©c isn‚Äôt used ƒë·∫øn determine if m·ªôt EtherChannel n√™n be formed - Interfaces l√† statically configured ƒë·∫øn form m·ªôt EtherChannel Up ƒë·∫øn 8 INTERFACES c√≥ th·ªÉ be formed into m·ªôt single EtherChannel (LACP allows up ƒë·∫øn 16 but only 8 s·∫Ω be ACTIVE, the other 8 s·∫Ω trong STANDBY mode, waiting cho m·ªôt active Giao di·ªán ƒë·∫øn fail) --- PAgP C·∫•u h√¨nh ![image](https://github.com/psaumur/CCNA/assets/106411237/d0c734e2-79ad-43ad-a50b-c17ced608021) üí° L∆∞u √Ω r·∫±ng ‚Äúauto‚Äù and ‚Äúdesirable‚Äù are the ONLY available modes cho PAgP ![image](https://github.com/psaumur/CCNA/assets/106411237/9eabb76a-1846-48d3-abb1-bd6898a432e7) PAgP negotiations ƒë·∫øn form m·ªôt EtherChannel üí° AWS1(config-if-range)# channel-group 1 mode desirable. Creating m·ªôt C·ªïng-channel Giao di·ªán C·ªïng-channel1 Shows up trong the Giao di·ªán as ‚ÄúC·ªïng-channel1‚Äù ![image](https://github.com/psaumur/CCNA/assets/106411237/bc0c1190-9e39-4ea2-923c-b29e03e9d40a) The ‚Äúchannel-group‚Äù number has ƒë·∫øn MATCH cho member INTERFACES tr√™n the same Switch. It DOESN‚ÄôT have ƒë·∫øn MATCH the ‚Äúchannel-group‚Äù number tr√™n the OTHER Switch! üí° (channel-group 1 tr√™n AWS1 c√≥ th·ªÉ form m·ªôt EtherChannel v·ªõi channel-group 2 tr√™n DSW1) --- LACP C·∫•u h√¨nh ![image](https://github.com/psaumur/CCNA/assets/106411237/ba4adcf6-dec5-456f-b8d7-ab4e6b722cbf) üí° L∆∞u √Ω r·∫±ng ‚Äúactive‚Äù and ‚Äúpassive‚Äù are the ONLY available modes cho LACP ![image](https://github.com/psaumur/CCNA/assets/106411237/0a314613-d398-49f1-a4d3-1b50fb96ab7d) LACP negotiations cho form m·ªôt EtherChannel The ‚Äúchannel-group‚Äù number has ƒë·∫øn MATCH cho member INTERFACES tr√™n the same Switch. It DOESN‚ÄôT have ƒë·∫øn MATCH the ‚Äúchannel-group‚Äù number tr√™n the OTHER Switch! üí° (channel-group 1 tr√™n AWS1 c√≥ th·ªÉ form m·ªôt EtherChannel v·ªõi channel-group 2 tr√™n DSW1) --- STATIC EtherChannel C·∫•u h√¨nh ![image](https://github.com/psaumur/CCNA/assets/106411237/92db26e7-21ae-40c6-89ee-abe0197ed8ad) üí° L∆∞u √Ω r·∫±ng ‚Äúon‚Äù is the ONLY available mode cho STATIC EtherChannel ON mode only works v·ªõi tr√™n Mode ON + desirable = DOES NOT WORK) ON + active = DOES NOT WORK --- C√°ch MANUALLY CONFIGURE THE NEGOTIATION Giao th·ª©c ![image](https://github.com/psaumur/CCNA/assets/106411237/83ef9bc8-4bd4-4dd3-b28e-83439ba96860) TWO OPTIONS: - LACP Giao th·ª©c - PAgP Giao th·ª©c (Above shows m·ªôt Giao th·ª©c mismatch error because LACP does not support ‚Äúdesirable‚Äù - only PAgP does) (‚Äúchannel-group 1 mode active‚Äù works because LACP supports ‚Äúactive‚Äù) --- AFTER CONFIGURING THE EtherChannel MODE CONFIGURING THE C·ªïng Giao di·ªán ![image](https://github.com/psaumur/CCNA/assets/106411237/c485cdf1-f0ed-44b8-8c91-c0553bf6d82d) ‚Äúshow running-config‚Äù shows ‚ÄúGiao di·ªán C·ªïng-channel1‚Äù in the C·∫•u h√¨nh ![image](https://github.com/psaumur/CCNA/assets/106411237/6adda3dd-6408-445f-bb3f-61847b3920b6) üí° NOTE the PHYSICAL INTERFACES (g0/0-g0/3) were auto-configured b·ªüi the C·ªïng-channel1 C·∫•u h√¨nh! --- IMPORTANT NOTES ABOUT EtherChannel C·∫•u h√¨nh - Member INTERFACES ph·∫£i have matching CONFIGURATIONS - Same DUPLEX (Full / Half) - Same SPEED - Same SWITCHPORT mode (Truy c·∫≠p / Trunk) - Same allowed VLANs / VLAN g·ªëc (for Trunk interfaces) - If m·ªôt Giao di·ªán‚Äôs configurations do NOT MATCH the others, it s·∫Ω be EXCLUDED t·ª´ the EtherChannel --- VERIFYING STATUS c·ªßa EtherChannel üí° ‚Äúshow EtherChannel summary‚Äù ![image](https://github.com/psaumur/CCNA/assets/106411237/9e0edb15-2806-4d51-afc9-ad67ed465a97) NOTE information t·∫°i bottom. (‚ÄùSU‚Äù means S - Layer2 + U - in use) Giao th·ª©c = What Giao th·ª©c the EtherChannel l√† using (in this case, LACP) ‚ÄúPorts‚Äù = the list c·ªßa interfaces trong the EtherChannel (P = bundled trong C·ªïng-channel) OTHER FLAGS ![image](https://github.com/psaumur/CCNA/assets/106411237/23d92ae1-9cc6-4f3a-9ddf-2ead59705c1c) ‚ÄúD‚Äù = Down ![image](https://github.com/psaumur/CCNA/assets/106411237/b1b3ce70-d9a6-4bd2-be4d-976077438c85) Changing one c·ªßa the Member interfaces using ‚Äúswitchport mode Truy c·∫≠p‚Äù has made it different than the other members so it l√† now appearing as ‚Äús‚Äù = suspended Another useful L·ªánh üí° ‚Äúshow EtherChannel C·ªïng-channel‚Äù ![image](https://github.com/psaumur/CCNA/assets/106411237/61731b0c-1cc5-4a7e-b92c-d0afbea0ac2d) üí° ‚Äúshow spanning-tree‚Äù will show the single EtherChannel C·ªïng Giao di·ªán ![image](https://github.com/psaumur/CCNA/assets/106411237/df0b9cc8-0448-4bbd-aefa-62fadf2b6089) --- LAYER 3 ETHERCHANNELS ![image](https://github.com/psaumur/CCNA/assets/106411237/c553ad64-1d8e-4a2a-a741-3102c89dc030) C√°ch CONFIGURE m·ªôt LAYER 3 EtherChannel (from m·ªôt clean C·∫•u h√¨nh) ![image](https://github.com/psaumur/CCNA/assets/106411237/c4520b2f-1e3b-49b8-85b1-458cdb6fc865) üí° ‚Äúshow running-config‚Äù ![image](https://github.com/psaumur/CCNA/assets/106411237/8638f32d-47c3-4c64-b68e-a9e2e0070ac9) NOTE : No SWITCHPORT v√† NO IP Giao di·ªán. Where do we configure the ƒê·ªãa ch·ªâ IP? Directly tr√™n the C·ªïng Giao di·ªán ! ![image](https://github.com/psaumur/CCNA/assets/106411237/3ec55a24-1de5-44a7-926c-f85500042115) ![image](https://github.com/psaumur/CCNA/assets/106411237/f99ea2a6-82fb-494a-b80d-a171732d5786) (‚ÄùRU‚Äù - ‚ÄúR‚Äù = Layer 3, ‚ÄúU‚Äù = in use) ![image](https://github.com/psaumur/CCNA/assets/106411237/acfe62c5-6908-4782-9440-1f75f842c2c9) --- COMMANDS LEARNED trong THIS CHAPTER ``` SW(config) port-channel load-balance *mode* ``` Configures the EtherChannel load-balancing method tr√™n m·ªôt Switch ``` SW# show etherchannel load-balance ``` Displays information about the load-balancing settings ``` SW(config-if)# channel-group *number* mode {desirable | auto | active | passive | on} ``` Configures m·ªôt Giao di·ªán ƒë·∫øn be PART c·ªßa m·ªôt EtherChannel ``` SW# show etherchannel summary ``` Displays m·ªôt summary c·ªßa EtherChannels tr√™n m·ªôt Switch ``` SW# show etherchannel port-channel ``` Displays information about the virtual C·ªïng-channel interfaces tr√™n m·ªôt Switch ![image](https://github.com/psaumur/CCNA/assets/106411237/6cae87f0-0226-40cc-92ba-b839c7a5ff53) 