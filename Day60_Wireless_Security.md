# 57. KHÔNG DÂY Bảo mật INTRO đến Không dây Mạng Bảo mật - Although Bảo mật là important trong ALL NETWORKS, it là even more essential trong Không dây NETWORKS - Because Không dây SIGNALS là not contained within một WIRE, any Thiết bị within range của the signal có thể receive traffic - In WIRED NETWORKS, traffic là often only ENCRYPTED when sent over một UNTRUSTED Mạng such as the Internet - In Không dây NETWORKS, it là VERY important đến ENCRYPT traffic sent between the Không dây CLIENTS và the AP - We sẽ cover THREE MAIN CONCEPTS: - Xác thực - Mã hóa - INTEGRITY --- Xác thực - All CLIENTS phải be AUTHENTICATED before they có thể associate với một AP - In một corporate setting, only TRUSTED USERS / DEVICES nên be given Truy cập đến the Mạng - In corporate settings, a separate SSID which doesn’t have Truy cập đến the corporate Mạng có thể be provided cho GUEST USERS - Ideally, CLIENTS nên also AUTHENTICATE the AP đến avoid associating với một malicious AP - There là MULTIPLE WAYS đến AUTHENTICATE: - Mật khẩu - USERNAME / Mật khẩu - CERTIFICATES ![image](https://github.com/psaumur/CCNA/assets/106411237/00d34740-8da7-428d-8b36-f8998ec2f0cd) --- Mã hóa - Traffic sent between CLIENTS và APs nên be ENCRYPTED so that it can’t be read bởi anyone except the AP và the CLIENT - There là many possible PROTOCOLS that có thể be used đến ENCRYPT traffic - All DEVICES trên the WLAN sẽ use the same Giao thức, however each CLIENT sẽ use một unique Mã hóa / DECRYPTION KEY so that other DEVICES can’t read its traffic - A “GROUP KEY” is used bởi the AP đến ENCRYPT traffic that it wants đến send đến all của its clients - All của the CLIENTS associated với the AP keep that key so they có thể DECRYPT the traffic --- INTEGRITY - As explained trong the “Bảo mật FUNDAMENTALS” video của the course, INTEGRITY ensures that the message là not modified bởi một third-party - The message that là sent bởi the SOURCE HOST nên be the same as the message that là received bởi the DESTINATION HOST - A MIC (Message Integrity Check) is added đến the message đến help protect their INTEGRITY. ![image](https://github.com/psaumur/CCNA/assets/106411237/b632c321-36e5-4a03-b08c-d0a2c2e215da) --- Xác thực METHODS The original 802.11 STANDARD included TWO OPTIONS cho Xác thực: - OPEN Xác thực - The CLIENT sends một Xác thực REQUEST và the AP just accepts it - The là clearly NOT một SECURE Xác thực method - After the CLIENT là AUTHENTICATED và associated với the AP, it’s possible đến require the USER đến AUTHENTICATE via other methods before Truy cập đến the Mạng là granted (ie: Starbucks WI-FI) - WEP (Wired Equivalent Privacy) - WEP là used đến provide both Xác thực và Mã hóa của Không dây traffic - For Mã hóa, WEP uses the RC4 ALGORITHM - WEP là a “SHARED-KEY” Giao thức, requiring the SENDER và RECEIVER đến have the same KEY - WEP KEYS có thể be 40 bits hoặc 104 bits trong length - The above KEYS là combined với một 24-bit “IV” (INITIALIZATION VECTOR) to bring the total length đến 64 bits hoặc 128 bits - WEP Mã hóa là NOT SECURE và có thể easily be cracked - WEP có thể be used cho Xác thực like this: ![image](https://github.com/psaumur/CCNA/assets/106411237/86e4f243-1692-41a6-9b15-6b2e99942e50) --- EAP (Extensible Xác thực Giao thức) - EAP là một Xác thực FRAMEWORK - It defines một STANDARD SET của Xác thực FUNCTIONS that là used bởi the various *EAP METHODS* - We sẽ look tại FOUR EAP METHODS: - LEAP - EAP-FAST - PEAP - EAP-TLS - EAP là integrated with **802.1X** which provides *Cổng-BASED Mạng Truy cập Kiểm soát* **802.1X** is used đến limit Mạng Truy cập cho CLIENTS connected đến một LAN hoặc WLAN until they AUTHENTICATE There are **THREE MAIN ENTITIES** in 802.1X: - SUPPLICANT : The Thiết bị that wants đến connect đến the Mạng - AUTHENTICATOR : The Thiết bị that provides Truy cập đến the Mạng - Xác thực SERVER (AS) : The Thiết bị that receives CLIENT credentials và PERMITS / DENIES Truy cập ![image](https://github.com/psaumur/CCNA/assets/106411237/5565e646-696f-4245-b1e5-d728fe0e3380) - LEAP (Lightweight EAP) - LEAP was developed bởi Cisco một an improvement over WEP - CLIENTS phải provide một USERNAME và Mật khẩu đến AUTHENTICATE - In addition, *MUTUAL Xác thực* is provided bởi both the CLIENT và SERVER sending một CHALLENGE PHRASE đến each other. - DYNAMIC WEP KEYS là used, meaning that the WEP KEYS là changed frequently - Like WEP, LEAP là considered vulnerable và nên not be used anymore ![image](https://github.com/psaumur/CCNA/assets/106411237/0b9ecce2-4219-42d0-8275-086b92134cda) - EAP-FAST (EAP FLEXIBLE Xác thực via SECURE TUNNELING) - EAP-FAST was also developed bởi Cisco - Consists của THREE PHASES: - A PAC (PROTECTED Truy cập CREDENTIAL) is generated và passed từ SERVER đến CLIENT - A SECURE TLS TUNNEL là established between the CLIENT và Xác thực SERVER - Inside của the SECURE (ENCRYPTED) TLS TUNNEL, the CLIENT và SERVER communicated further đến AUTHENTICATE / AUTHORIZE the CLIENT ![image](https://github.com/psaumur/CCNA/assets/106411237/f17d6f7b-9f87-4cb2-be24-5d8c95dc0cfc) - PEAP (PROTECTED EAP) - Like EAP-FAST, PEAP involves establishing một SECURE TLS TUNNEL between the CLIENT và SERVER - Instead của một PAC, the SERVER has một DIGITAL CERTIFICATE - The CLIENT uses this DIGITAL CERTIFICATE đến AUTHENTICATE the SERVER - The CERTIFICATE là also used đến establish một TLS TUNNEL - Because only the SERVER provides một CERTIFICATE cho Xác thực, the CLIENT phải still be AUTHENTICATED within the SECURE TUNNEL - Example: MS-CHAP (Microsoft Challenge-Handshake Xác thực Giao thức) ![image](https://github.com/psaumur/CCNA/assets/106411237/0f9babe7-d86f-49c8-b732-20f31ea26437) - EAP-TLS (EAP TRANSPORT LAYER Bảo mật) - Whereas PEAP only requires the AS đến have một CERTIFICATE, EAP-TLS requires một CERTIFICATE trên the AS và trên every single CLIENT - EAP-TLS là the MOST SECURE Không dây Xác thực method, but it là more difficult đến implement than PEAP because every CLIENT Thiết bị needs một CERTIFICATE - Because the CLIENT và SERVER AUTHENTICATE each other với DIGITAL CERTIFICATES, there là no need đến AUTHENTICATE the CLIENT within the TLS TUNNEL - The TLS TUNNEL là still used đến exchange Mã hóa KEY information (Mã hóa methods sẽ be discussed next) ![image](https://github.com/psaumur/CCNA/assets/106411237/c6c57595-fd75-4761-8760-29fab8dbf698) --- Mã hóa / INTEGRITY METHODS - TKIP (Temporal Key Integrity Giao thức) - WEP was found đến be vulnerable, but Không dây hardware tại the time was built đến use WEP - A temporary solution was needed until một new STANDARD was created và một new HARDWARE was built - TKIP adds various Bảo mật FEATURES: - A MIC (Message Integrity Check) is added đến protect the integrity của messages - A KEY MIXING ALGORITHM là used đến create một unique WEP key cho every Khung - The INITIALIZATION VECTOR là doubled trong length từ 24 bits đến 48 bits, making BRUTE-FORCE attacks much more difficult - The MIC includes the SENDER Địa chỉ MAC đến identify the Khung’s SENDER - A TIMESTAMP là added đến the MIC đến prevent replay attacks. Replay attacks involved re-resending một Khung that has already been transmitted - A TKIP SEQUENCE NUMBER là used đến keep track của FRAMES sent từ each SOURCE Địa chỉ MAC. This also protects against REPLAY ATTACKS ** You probably don’t need đến memorize ALL của the above features ** TKIP là used trong WPA version 1, which sẽ be discussed trong the next section - CCMP (Counter / CBC-MAC Giao thức) - CCMP was developed after TKIP và là more SECURE - It là used trong WPA2 - To use CCMP, it phải be supported bởi the Thiết bị’S hardware. - Old hardware built only đến use WEP / TKIP cannot use CCMP - CCMP consists của TWO DIFFERENT ALGORITHMS đến provide Mã hóa và MIC : - AES (Advanced Mã hóa Standard) COUNTER MODE Mã hóa - AES là the MOST SECURE Mã hóa Giao thức currently available. - Widely used all over the world - There là multiple MODES của operation cho AES. - CCMP uses “COUNTER MODE” - CBC-MAC (CIPHER BLOCK CHAINING MESSAGE Xác thực CODE) - Used as một MIC đến ENSURE the INTEGRITY của MESSAGES - GCMP (GALOIS / COUNTER MODE Giao thức) - GCMP là MORE SECURE và EFFICIENT than CCMP - Its increased efficiency allows higher data throughput than CCMP - It là used trong WPA3 - GCMP consists của TWO ALGORITHMS: - AES COUNTER MODE Mã hóa - GMAC (GALOIS MESSAGE Xác thực CODE) - Used as một MIC đến ENSURE the INTEGRITY của MESSAGE --- WI-FI PROTECTED Truy cập (WPA) - The WI-FI Alliance has developed THREE WPA CERTIFICATIONS cho Không dây DEVICES: - WPA - WPA2 - WPA3 - To be WPA-CERTIFIED, EQUIPMENT phải be TESTED trong authorized testing labs - All của the above support TWO Xác thực MODES: - PERSONAL MODE : - A PRE-SHARED KEY (PSK) is used cho AUTHENTICATOIN - When you connect đến một home WI-FI Mạng, enter the Mật khẩu và là AUTHENTICATED, that là PERSONAL MODE - This là common trong small NETWORKS - The PSK itself là NOT sent over the air - A FOUR-WAY HANDSHAKE là used cho Xác thực và the PSK là used đến GENERATE Mã hóa KEYS - Doanh nghiệp MODE : - 802.1X là used với một Xác thực SERVER (RADIUS SERVER) - No specific EAP METHOD là specified, so all là supported (PEAP, EAP-TLS, etc) WPA - The WPA CERTIFICATION was developed after WEP was proven đến be vulnerable và includes the following PROTOCOLS: - TKIP (based trên WEP) provides Mã hóa / MIC - 802.1X Xác thực (Doanh nghiệp MODE) or PSK (PERSONAL MODE) WPA2 - Was released trong 2004 và includes the following PROTOCOLS: - CCMP provides Mã hóa / MIC - 802.1X Xác thực (Doanh nghiệp MODE) or PSK (PERSONAL MODE) WPA3 - Was released trong 2018 và includes the following PROTOCOLS: - GCMP provides Mã hóa / MIC - 802.1X Xác thực (Doanh nghiệp MODE) or PSK (PERSONAL MODE) - WPA3 also provides several additional Bảo mật features: - PMF (PROTECTED Quản lý FRAMES) - Protecting 802.11 Quản lý FRAMES từ eavesdropping / forging - SAE (SIMULTANEOUS Xác thực của EQUALS) - Protects the four-way handshake when using PERSONAL MODE Xác thực - FORWARD SECRECY - Prevents DATA từ being DECRYPTED after it has been transmitted over the air so một ATTACKER can’t capture Không dây FRAMES và then try đến DECRYPT them later 