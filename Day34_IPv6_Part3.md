# 33. IPV6 : PART 3 CORRECTION Ä‘áº¿n PRIOR LECTURES: RFC Requirements cho IPv6 Äá»‹a chá»‰ Representation - Leading 0s pháº£i be removed - This - 2001 : 0db8 : 0000 : 0001 : 0f2a : 4fff : fea3 : 00b1 - Becomes - 2001 : db8 : 0 : 1 : f2a : 4fff : fea3 : b1 - :: MUST be used Ä‘áº¿n shorten the longest string cá»§a all-0 quartets - If there lÃ  only ONE all-0 quartet, donâ€™t use â€˜::â€™ - This - 2001 : 0000 : 0000 : 0000 : 0f2a : 0000 : 0000 : 00b1 - Becomes - 2001 :: f2a : 0 : 0 : b1 - If there lÃ  two equal-length choices cho the :: , use :: to the shorten the one trÃªn the LEFT - This - 2001 : 0db8 : 0000 : 0000 : 0f2a : 0000 : 0000 : 00b1 - Becomes - 2001 : db8 :: f2a : 0 : 0 : b1 - Hexadecimal characters â€˜aâ€™, â€˜bâ€™, â€˜câ€™, â€˜dâ€™, â€˜eâ€™, and â€˜fâ€™ MUST be written using lower-case, NOT upper case má»™t B C D E F --- IPv6 Header ![image](https://github.com/psaumur/CCNA/assets/106411237/5bba7262-60aa-4348-9b7a-55dc354f4ed3) Length lÃ  ALWAYS 40 bytes (Fixed Header) Version (4 bits) - Indicates version cá»§a IP used - Fixed value of â€˜6â€™ (0b0110) to indicate IPv6 Traffic Class (8 bits) - Used cho QoS (Cháº¥t lÆ°á»£ng dá»‹ch vá»¥) to indicate high-priority traffic - Example: IP phone traffic, live video calls, etc. Flow Label (20 bits) - Identifies specific traffic â€œflowsâ€ (communication between Source vÃ  Destination) Payload Length (16 bits) - Indicates the LENGTH cá»§a the PAYLOAD (the ÄÃ³ng gÃ³i LAYER 4 Äoáº¡n) **in bytes** - The length cá»§a the IPv6 Header, itself, isnâ€™t included, because itâ€™s ALWAYS 40 bytes Next Header (8 bits) - Indicates the TYPE cá»§a the â€˜next Headerâ€™ (Header cá»§a the encapsulated Äoáº¡n) - Example: TCP hoáº·c UDP - Same function as Header IPV4â€™s â€˜Giao thá»©câ€™ field Hop Limit (8 bits) - Value trong this field decrements bá»Ÿi 1 every time má»™t Router forwards it. If it reaches â€˜0â€™, the GÃ³i tin lÃ  discarded (similar Ä‘áº¿n IPv4 TTL field ) Source Äá»‹a chá»‰ (128 bits) - GÃ³i tinâ€™s SOURCE Äá»‹a chá»‰ Destination Äá»‹a chá»‰ (128 bits) - GÃ³i tinâ€™s DESTINATION Äá»‹a chá»‰ --- SOLICITED-NODE Multicast Äá»‹a chá»‰ - An IPv6 SOLICITED-NODE Multicast Äá»‹a chá»‰ lÃ  calculated tá»« má»™t Unicast Äá»‹a chá»‰ CÃ¡ch generate má»™t SOLICITED-NODE Multicast Äá»‹a chá»‰ ![image](https://github.com/psaumur/CCNA/assets/106411237/eef6815b-405b-485d-884d-ff08bbbf16d3) Note the automatically joined group addresses cho this IPv6 Giao diá»‡n ![image](https://github.com/psaumur/CCNA/assets/106411237/4f981645-7488-4f0c-8ec5-d7c1b878acba) --- NEIGHBOR DISCOVERY Giao thá»©c (NDP) - NEIGHBOR DISCOVERY Giao thá»©c (NDP) is má»™t Giao thá»©c used vá»›i IPv6 - It has various functions vÃ  one cá»§a those functions lÃ  Ä‘áº¿n replace ARP, which lÃ  no longer used trong IPv6 - The ARP-like function cá»§a NDP uses ICMPv6 vÃ  SOLICITED-MODE Multicast Addresses Ä‘áº¿n learn the Äá»‹a chá»‰ MAC cá»§a other HOSTS (ARP trong IPv4 uses Broadcast Messages) - TWO MESSAGES types lÃ  used: - 1) NEIGHBOR SOLICITATION (NS) - ICMPv6 Type 135 - 2) NEIGHBOR ADVERTISEMENT (NA) - ICMPv6 Type 136 ![image](https://github.com/psaumur/CCNA/assets/106411237/88b9dde5-bc94-49ce-ba4a-b38c47f4670d) ![image](https://github.com/psaumur/CCNA/assets/106411237/cc9010cb-eb67-4fcb-8c6a-7a0aa11c7057) IPv6 NEIGHBOR TABLE ![image](https://github.com/psaumur/CCNA/assets/106411237/085bb9df-8015-4c2f-bfc8-2d6336436fe2) - Another function cá»§a NDP allows HOSTS Ä‘áº¿n automatically discover ROUTERS trÃªn the LOCAL Máº¡ng - TWO MESSAGES lÃ  used cho this process: - Router SOLICITATION (RS) - ICMPv6 Type 133 - Sent Ä‘áº¿n Multicast Äá»‹a chá»‰ `FF02::2` (All Routers) - Asks ALL ROUTERS trÃªn the Local Link Ä‘áº¿n identify themselves - Sent when má»™t Giao diá»‡n lÃ  enabled / HOST lÃ  connected Ä‘áº¿n the Máº¡ng - Router ADVERTISEMENT (RA) - ICMPv6 Type 134 - Sent Ä‘áº¿n Multicast Äá»‹a chá»‰ `FF02::1` (All Nodes) - The Router announces its presence, as well as other information about the link - These messages lÃ  sent trong response Ä‘áº¿n RS messages - They lÃ  also sent periodically, even if the Router hasnâ€™t received má»™t RS ![image](https://github.com/psaumur/CCNA/assets/106411237/f7861fda-e893-4fd1-b5c3-5deed57de2f0) --- SLAAC - Stands for **STATELESS Äá»‹a chá»‰ AUTO-Cáº¥u hÃ¬nh** - HOSTS use the RS / RA messages Ä‘áº¿n learn the IPv6 Prefix cá»§a the LOCAL LINK (ie: 2000:db8:: /64) and then automatically generate má»™t IPv6 Äá»‹a chá»‰ - Using the `ipv6 address prefix / prefix-length eui-64` Lá»‡nh, you need Ä‘áº¿n manually enter the prefix - Using the `ipv6 address autoconfig` Lá»‡nh, you DONâ€™T need Ä‘áº¿n enter the prefix. The Thiáº¿t bá»‹ uses NDP Ä‘áº¿n learn the prefix used trÃªn the local link - The Thiáº¿t bá»‹ sáº½ use EUI-64 Ä‘áº¿n generate the Giao diá»‡n ID hoáº·c it sáº½ be randomly generated (depending trÃªn the Thiáº¿t bá»‹ / maker) ![image](https://github.com/psaumur/CCNA/assets/106411237/e1cc9b26-1a81-48fb-8538-77f97d456eff) --- DUPLICATE Äá»‹a chá»‰ DETECTION (DAD) - One final point about NDP! - Duplicate Äá»‹a chá»‰ Detection (DAD) allows HOSTS Ä‘áº¿n check if other devices trÃªn the Local Link lÃ  using the same IPv6 Äá»‹a chá»‰ - Any time má»™t IPv6-enabled Giao diá»‡n initializes (`no shutdown` Lá»‡nh) or má»™t IPv6 Äá»‹a chá»‰ lÃ  configured trÃªn má»™t Giao diá»‡n (by any method: manual, SLAAC, etc.) it performs DAD - DAD uses TWO MESSAGES you learned earlier : NS vÃ  NA - The HOST sáº½ send má»™t NS Ä‘áº¿n its own IPv6 Äá»‹a chá»‰. - If it doesnâ€™t get má»™t reply, it KNOWS the Äá»‹a chá»‰ lÃ  unique - If it DOES get má»™t reply, it means ANOTHER HOST trÃªn the Máº¡ng lÃ  already using that Äá»‹a chá»‰ --- IPv6 STATIC Äá»‹nh tuyáº¿n - IPv6 Äá»‹nh tuyáº¿n works the same as IPv4 Äá»‹nh tuyáº¿n - However, the TWO processes lÃ  separate trÃªn the Router, and the TWO Äá»‹nh tuyáº¿n tables lÃ  separate, as well. - IPv4 Äá»‹nh tuyáº¿n lÃ  enabled bá»Ÿi Default - IPv6 Äá»‹nh tuyáº¿n lÃ  disabled bá»Ÿi Default - MUST BE ENABLED vá»›i the `ipv6 unicast-routing` Lá»‡nh - If IPv6 Äá»‹nh tuyáº¿n lÃ  disabled, the Router sáº½ be able Ä‘áº¿n SEND vÃ  RECEIVE IPv6 traffic, but sáº½ not *Tuyáº¿n Ä‘Æ°á»ng* IPv6 traffic (ie: will NOT FORWARD it between NETWORKS) ![image](https://github.com/psaumur/CCNA/assets/106411237/e082920f-3a76-438d-b43d-8eac968dcd55) ![image](https://github.com/psaumur/CCNA/assets/106411237/90acb6ca-2703-47d1-907f-1878490c78f6) - A CONNECTED Máº¡ng Tuyáº¿n Ä‘Æ°á»ng lÃ  automatically added cho EACH CONNECTED Máº¡ng - A LOCAL HOST Tuyáº¿n Ä‘Æ°á»ng lÃ  automatically added cho each Äá»‹a chá»‰ configured trÃªn the Router - Routes cho Link-Local ADDRESSES lÃ  not added Ä‘áº¿n the Äá»‹nh tuyáº¿n TABLE ![image](https://github.com/psaumur/CCNA/assets/106411237/d01849d3-c031-45a0-8e31-efd9dba61df6) Everything lÃ  configured similar Ä‘áº¿n normal static routes trong IPv4 [AD] = Khoáº£ng cÃ¡ch quáº£n trá»‹. You NEED this value trong order Ä‘áº¿n configure má»™t STATIC Tuyáº¿n Ä‘Æ°á»ng DIRECTLY ATTACHED Static Tuyáº¿n Ä‘Æ°á»ng: - Only the EXIT Giao diá»‡n lÃ  specified - `ipv6 route destination / prefix-length exit-interface` - Example : `~~R1(config)# ipv6 route 2001:db8:0:3:: /64 g0/0~~` <aside> ğŸ’¡ In IPv6, you CANNOT use DIRECTLY ATTACHED Static Routes if the Giao diá»‡n lÃ  má»™t Ethernet Giao diá»‡n </aside> RECURSIVE Static Tuyáº¿n Ä‘Æ°á»ng: - Only the Next-Hop lÃ  specified - `ipv6 route destination / prefix-length next-hop` - Example: `R1(config)# ipv6 route 2001:db8:0:3::/64 2001:db8:0:12::2` FULLY SPECIFIED Static Tuyáº¿n Ä‘Æ°á»ng: - Both the Exit Giao diá»‡n vÃ  Next Hop lÃ  specified - `ipv6 route destination / prefix-length exit-interface next-hop` - Example: `R1(config)# ipv6 route 2001:db8:0:3::/64 g0/0 2001:db8:0:12::2` --- (LÆ°u Ã½ ráº±ng THESE ROUTES lÃ  ALL RECURSIVE : They specify the Next-Hop) Máº¡ng Tuyáº¿n Ä‘Æ°á»ng: `R1(config)# ipv6 route 2001:db8:0::/64 2001:db8:0:12::2` This lÃ  má»™t Tuyáº¿n Ä‘Æ°á»ng Ä‘áº¿n R3/PC2 Máº¡ng via R2â€™s G0/0 Giao diá»‡n (We did this trong Day 32â€™s Lab) HOST Tuyáº¿n Ä‘Æ°á»ng: `R2(config)# ipv6 route 2001:db8:0:1::100/128 2001:db8:0:12::1` `R2(config)# ipv6 route 2001:db8:0:3::100/128 2001:db8:0:23::2` This lÃ  má»™t Tuyáº¿n Ä‘Æ°á»ng tá»« R2 Ä‘áº¿n PC1 vÃ  PC2 using the â€œnext hopâ€ ADDRESSES cá»§a R1 vÃ  R3 G0/0 INTERFACES Note the /128 prefix. This lÃ  how SPECIFIC IPv6 ADDRESSES lÃ  written Default Tuyáº¿n Ä‘Æ°á»ng: `R3(config)# ipv6 route ::/0 2001:db8:0:23::1` ::/0 lÃ  the IPv6 equivalent cá»§a 0.0.0.0/0 trong IPv4 FLOATING STATIC ROUTES: - Require you Ä‘áº¿n increase the [AD] number HIGHER than the currently used Máº¡ng IGP AD value LINK-LOCAL NEXT HOPS: ![image](https://github.com/psaumur/CCNA/assets/106411237/52cf09e2-2b37-4319-a2b9-15213524530c) You HAVE Ä‘áº¿n specify the Giao diá»‡n name when using Link-Local Next-Hops This lÃ  EXACTLY like má»™t FULLY-SPECIFIED STATIC Tuyáº¿n Ä‘Æ°á»ng 