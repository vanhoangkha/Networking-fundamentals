# 33. IPV6 : PART 3 CORRECTION đến PRIOR LECTURES: RFC Requirements cho IPv6 Địa chỉ Representation - Leading 0s phải be removed - This - 2001 : 0db8 : 0000 : 0001 : 0f2a : 4fff : fea3 : 00b1 - Becomes - 2001 : db8 : 0 : 1 : f2a : 4fff : fea3 : b1 - :: MUST be used đến shorten the longest string của all-0 quartets - If there là only ONE all-0 quartet, don’t use ‘::’ - This - 2001 : 0000 : 0000 : 0000 : 0f2a : 0000 : 0000 : 00b1 - Becomes - 2001 :: f2a : 0 : 0 : b1 - If there là two equal-length choices cho the :: , use :: to the shorten the one trên the LEFT - This - 2001 : 0db8 : 0000 : 0000 : 0f2a : 0000 : 0000 : 00b1 - Becomes - 2001 : db8 :: f2a : 0 : 0 : b1 - Hexadecimal characters ‘a’, ‘b’, ‘c’, ‘d’, ‘e’, and ‘f’ MUST be written using lower-case, NOT upper case một B C D E F --- IPv6 Header ![image](https://github.com/psaumur/CCNA/assets/106411237/5bba7262-60aa-4348-9b7a-55dc354f4ed3) Length là ALWAYS 40 bytes (Fixed Header) Version (4 bits) - Indicates version của IP used - Fixed value of ‘6’ (0b0110) to indicate IPv6 Traffic Class (8 bits) - Used cho QoS (Chất lượng dịch vụ) to indicate high-priority traffic - Example: IP phone traffic, live video calls, etc. Flow Label (20 bits) - Identifies specific traffic “flows” (communication between Source và Destination) Payload Length (16 bits) - Indicates the LENGTH của the PAYLOAD (the Đóng gói LAYER 4 Đoạn) **in bytes** - The length của the IPv6 Header, itself, isn’t included, because it’s ALWAYS 40 bytes Next Header (8 bits) - Indicates the TYPE của the ‘next Header’ (Header của the encapsulated Đoạn) - Example: TCP hoặc UDP - Same function as Header IPV4’s ‘Giao thức’ field Hop Limit (8 bits) - Value trong this field decrements bởi 1 every time một Router forwards it. If it reaches ‘0’, the Gói tin là discarded (similar đến IPv4 TTL field ) Source Địa chỉ (128 bits) - Gói tin’s SOURCE Địa chỉ Destination Địa chỉ (128 bits) - Gói tin’s DESTINATION Địa chỉ --- SOLICITED-NODE Multicast Địa chỉ - An IPv6 SOLICITED-NODE Multicast Địa chỉ là calculated từ một Unicast Địa chỉ Cách generate một SOLICITED-NODE Multicast Địa chỉ ![image](https://github.com/psaumur/CCNA/assets/106411237/eef6815b-405b-485d-884d-ff08bbbf16d3) Note the automatically joined group addresses cho this IPv6 Giao diện ![image](https://github.com/psaumur/CCNA/assets/106411237/4f981645-7488-4f0c-8ec5-d7c1b878acba) --- NEIGHBOR DISCOVERY Giao thức (NDP) - NEIGHBOR DISCOVERY Giao thức (NDP) is một Giao thức used với IPv6 - It has various functions và one của those functions là đến replace ARP, which là no longer used trong IPv6 - The ARP-like function của NDP uses ICMPv6 và SOLICITED-MODE Multicast Addresses đến learn the Địa chỉ MAC của other HOSTS (ARP trong IPv4 uses Broadcast Messages) - TWO MESSAGES types là used: - 1) NEIGHBOR SOLICITATION (NS) - ICMPv6 Type 135 - 2) NEIGHBOR ADVERTISEMENT (NA) - ICMPv6 Type 136 ![image](https://github.com/psaumur/CCNA/assets/106411237/88b9dde5-bc94-49ce-ba4a-b38c47f4670d) ![image](https://github.com/psaumur/CCNA/assets/106411237/cc9010cb-eb67-4fcb-8c6a-7a0aa11c7057) IPv6 NEIGHBOR TABLE ![image](https://github.com/psaumur/CCNA/assets/106411237/085bb9df-8015-4c2f-bfc8-2d6336436fe2) - Another function của NDP allows HOSTS đến automatically discover ROUTERS trên the LOCAL Mạng - TWO MESSAGES là used cho this process: - Router SOLICITATION (RS) - ICMPv6 Type 133 - Sent đến Multicast Địa chỉ `FF02::2` (All Routers) - Asks ALL ROUTERS trên the Local Link đến identify themselves - Sent when một Giao diện là enabled / HOST là connected đến the Mạng - Router ADVERTISEMENT (RA) - ICMPv6 Type 134 - Sent đến Multicast Địa chỉ `FF02::1` (All Nodes) - The Router announces its presence, as well as other information about the link - These messages là sent trong response đến RS messages - They là also sent periodically, even if the Router hasn’t received một RS ![image](https://github.com/psaumur/CCNA/assets/106411237/f7861fda-e893-4fd1-b5c3-5deed57de2f0) --- SLAAC - Stands for **STATELESS Địa chỉ AUTO-Cấu hình** - HOSTS use the RS / RA messages đến learn the IPv6 Prefix của the LOCAL LINK (ie: 2000:db8:: /64) and then automatically generate một IPv6 Địa chỉ - Using the `ipv6 address prefix / prefix-length eui-64` Lệnh, you need đến manually enter the prefix - Using the `ipv6 address autoconfig` Lệnh, you DON’T need đến enter the prefix. The Thiết bị uses NDP đến learn the prefix used trên the local link - The Thiết bị sẽ use EUI-64 đến generate the Giao diện ID hoặc it sẽ be randomly generated (depending trên the Thiết bị / maker) ![image](https://github.com/psaumur/CCNA/assets/106411237/e1cc9b26-1a81-48fb-8538-77f97d456eff) --- DUPLICATE Địa chỉ DETECTION (DAD) - One final point about NDP! - Duplicate Địa chỉ Detection (DAD) allows HOSTS đến check if other devices trên the Local Link là using the same IPv6 Địa chỉ - Any time một IPv6-enabled Giao diện initializes (`no shutdown` Lệnh) or một IPv6 Địa chỉ là configured trên một Giao diện (by any method: manual, SLAAC, etc.) it performs DAD - DAD uses TWO MESSAGES you learned earlier : NS và NA - The HOST sẽ send một NS đến its own IPv6 Địa chỉ. - If it doesn’t get một reply, it KNOWS the Địa chỉ là unique - If it DOES get một reply, it means ANOTHER HOST trên the Mạng là already using that Địa chỉ --- IPv6 STATIC Định tuyến - IPv6 Định tuyến works the same as IPv4 Định tuyến - However, the TWO processes là separate trên the Router, and the TWO Định tuyến tables là separate, as well. - IPv4 Định tuyến là enabled bởi Default - IPv6 Định tuyến là disabled bởi Default - MUST BE ENABLED với the `ipv6 unicast-routing` Lệnh - If IPv6 Định tuyến là disabled, the Router sẽ be able đến SEND và RECEIVE IPv6 traffic, but sẽ not *Tuyến đường* IPv6 traffic (ie: will NOT FORWARD it between NETWORKS) ![image](https://github.com/psaumur/CCNA/assets/106411237/e082920f-3a76-438d-b43d-8eac968dcd55) ![image](https://github.com/psaumur/CCNA/assets/106411237/90acb6ca-2703-47d1-907f-1878490c78f6) - A CONNECTED Mạng Tuyến đường là automatically added cho EACH CONNECTED Mạng - A LOCAL HOST Tuyến đường là automatically added cho each Địa chỉ configured trên the Router - Routes cho Link-Local ADDRESSES là not added đến the Định tuyến TABLE ![image](https://github.com/psaumur/CCNA/assets/106411237/d01849d3-c031-45a0-8e31-efd9dba61df6) Everything là configured similar đến normal static routes trong IPv4 [AD] = Khoảng cách quản trị. You NEED this value trong order đến configure một STATIC Tuyến đường DIRECTLY ATTACHED Static Tuyến đường: - Only the EXIT Giao diện là specified - `ipv6 route destination / prefix-length exit-interface` - Example : `~~R1(config)# ipv6 route 2001:db8:0:3:: /64 g0/0~~` <aside> 💡 In IPv6, you CANNOT use DIRECTLY ATTACHED Static Routes if the Giao diện là một Ethernet Giao diện </aside> RECURSIVE Static Tuyến đường: - Only the Next-Hop là specified - `ipv6 route destination / prefix-length next-hop` - Example: `R1(config)# ipv6 route 2001:db8:0:3::/64 2001:db8:0:12::2` FULLY SPECIFIED Static Tuyến đường: - Both the Exit Giao diện và Next Hop là specified - `ipv6 route destination / prefix-length exit-interface next-hop` - Example: `R1(config)# ipv6 route 2001:db8:0:3::/64 g0/0 2001:db8:0:12::2` --- (Lưu ý rằng THESE ROUTES là ALL RECURSIVE : They specify the Next-Hop) Mạng Tuyến đường: `R1(config)# ipv6 route 2001:db8:0::/64 2001:db8:0:12::2` This là một Tuyến đường đến R3/PC2 Mạng via R2’s G0/0 Giao diện (We did this trong Day 32’s Lab) HOST Tuyến đường: `R2(config)# ipv6 route 2001:db8:0:1::100/128 2001:db8:0:12::1` `R2(config)# ipv6 route 2001:db8:0:3::100/128 2001:db8:0:23::2` This là một Tuyến đường từ R2 đến PC1 và PC2 using the “next hop” ADDRESSES của R1 và R3 G0/0 INTERFACES Note the /128 prefix. This là how SPECIFIC IPv6 ADDRESSES là written Default Tuyến đường: `R3(config)# ipv6 route ::/0 2001:db8:0:23::1` ::/0 là the IPv6 equivalent của 0.0.0.0/0 trong IPv4 FLOATING STATIC ROUTES: - Require you đến increase the [AD] number HIGHER than the currently used Mạng IGP AD value LINK-LOCAL NEXT HOPS: ![image](https://github.com/psaumur/CCNA/assets/106411237/52cf09e2-2b37-4319-a2b9-15213524530c) You HAVE đến specify the Giao diện name when using Link-Local Next-Hops This là EXACTLY like một FULLY-SPECIFIED STATIC Tuyến đường 