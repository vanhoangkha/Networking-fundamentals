# 22. RAPID SPANNING TREE GIAO TH·ª®C *COMPARISON c·ªßa STP VERSIONS (Standard vs. Cisco)* ![image](https://github.com/psaumur/CCNA/assets/106411237/ca5ff85c-842e-4ed3-9b6a-f9d6ed546a78) We l√† only concerned v·ªõi 802.1w cho MOST use cases. MSTP (802.1s) is more useful cho VERY LARGE networks. l√† g√¨ RAPID PER-VLAN Spanning Tree PLUS? > RSTP l√† not m·ªôt time-based Spanning Tree algorithm like 802.1D. Therefore, RSTP offers m·ªôt improvment over teh 30 seconds ho·∫∑c more 802.1D takes ƒë·∫øn move m·ªôt link ƒë·∫øn forwarding. The heart c·ªßa the Giao th·ª©c l√† m·ªôt new Bridge-Bridge handshake mechanism, which allows ports ƒë·∫øn move directly ƒë·∫øn forwarding --- SIMILARITIES BETWEEN STP v√† RSTP: - RSTP serves the same purpose as STP, blocking specific PORTS ƒë·∫øn prevent LAYER 2 LOOPS. - RSTP elects m·ªôt Bridge g·ªëc v·ªõi the same rules as STP - RSTP elects ROOT PORTS v·ªõi the same rules as STP - RSTP elects DESIGNATED PORTS v·ªõi the same rules as STP --- DIFFERENCES BETWEEN STP v√† RSTP: **C·ªïng COSTS** ![image](https://github.com/psaumur/CCNA/assets/106411237/b250c6da-2579-4576-8e93-5a8f8e66d873) (STUDY v√† MEMORIZE C·ªïng COSTS c·ªßa STP v√† RSTP) RSTP C·ªïng STATES ![image](https://github.com/psaumur/CCNA/assets/106411237/054d5037-a60e-478e-986b-6f43825a0d1a) - If m·ªôt C·ªïng has been ADMINISTRATIVELY DISABLED (‚Äùshutdown‚Äù L·ªánh) = DISCARDING STATE - If m·ªôt C·ªïng l√† ENABLED but BLOCKING traffic ƒë·∫øn prevent LAYER 2 LOOPS = DISCARDING STATE --- RSTP ROLES - The ROOT C·ªïng role remains unchanged trong RSTP - The C·ªïng that l√† closest ƒë·∫øn the Bridge g·ªëc becomes the ROOT C·ªïng cho the Switch - The Bridge g·ªëc l√† the only Switch that doesn‚Äôt have m·ªôt ROOT C·ªïng - The DESIGNATED C·ªïng role remains unchanged trong RSTP - The C·ªïng tr√™n m·ªôt ƒêo·∫°n (Collision Domain) that sends the best BPDU l√† that ƒêo·∫°n‚Äôs DESIGNATED C·ªïng (only one per ƒêo·∫°n!) - The NON-DESIGNATED C·ªïng role l√† split into TWO separate roles trong RSTP: - The ALTERNATE C·ªïng role - The BACKUP C·ªïng role **RSTP : ALTERNATE C·ªïng ROLE** - The RSTP ALTERNATE C·ªïng ROLE l√† m·ªôt DISCARDING C·ªïng that receives m·ªôt superior BPDU t·ª´ another Switch - This l√† the same as what you‚Äôve learned about BLOCKING PORTS trong classic STP ![image](https://github.com/psaumur/CCNA/assets/106411237/7d81e70c-3b31-4448-9d45-9aadb738c74d) - An ALTERNATE C·ªïng (labelled ‚ÄúA‚Äù above) functions as m·ªôt backup ƒë·∫øn the ROOT C·ªïng - If the ROOT C·ªïng fails, the Switch c√≥ th·ªÉ immediately move it‚Äôs best alternate C·ªïng ƒë·∫øn FORWARDING ![image](https://github.com/psaumur/CCNA/assets/106411237/41f3be85-6225-4749-83b4-f76952c5756a) üí° This immediate move ƒë·∫øn FORWARDING STATE functions like m·ªôt classic STP optional feature called **UplinkFast.** Because it l√† built into RSTP, you do not need ƒë·∫øn activate UplinkFast when using RSTP/Rapid PVST+ One more STP optional feature that was built into RSTP is **BackboneFast** ![image](https://github.com/psaumur/CCNA/assets/106411237/c4cea7b7-599f-4ec8-b9d3-a5acba71a5f5) - **BackboneFast** allows SW3 ƒë·∫øn expire the MAX AGE TIMERS tr√™n it‚Äôs Giao di·ªán v√† rapidly FORWARD the superior BPDUs ƒë·∫øn SW2 - This FUNCTIONALITY l√† built into RSTP, so it does not need ƒë·∫øn be configured. UPLINKFAST v√† BACKBONE FAST (SUMMARY) üí° **UplinkFast** and **BackboneFast** are two optional features trong Classic STP. They ph·∫£i be configured ƒë·∫øn operate tr√™n the Switch (not necessary ƒë·∫øn know cho the CCNA) - Both features l√† built into RSTP, so you do NOT have ƒë·∫øn configure them. They operate, by Default - You do NOT need ƒë·∫øn have m·ªôt detailed understanding c·ªßa them cho the CCNA. Know their names v√† their BASIC purpose (to help BLOCKING / DISCARDING PORTS rapidly move ƒë·∫øn FORWARDING) --- **RSTP : BACKUP C·ªïng ROLE** - The RSTP BACKUP C·ªïng role l√† m·ªôt DISCARDING C·ªïng that receives m·ªôt superior BPDU t·ª´ another Giao di·ªán tr√™n the same Switch - This only happens when TWO INTERFACES l√† connected ƒë·∫øn the SAME COLLISION DOMAIN (via m·ªôt Hub) - Hubs l√† NOT used trong modern networks, so you s·∫Ω probably NOT encounter m·ªôt RSTP BACKUP C·ªïng - Hubs l√† NOT used trong modern networks, so you s·∫Ω probably NOT encounter m·ªôt RSTP BACKUP C·ªïng. - Functions as m·ªôt BACKUP cho m·ªôt DESIGNATED C·ªïng üí° The Giao di·ªán v·ªõi the LOWERS C·ªïng ID s·∫Ω be selected as the DESIGNATED C·ªïng, and the other s·∫Ω be the BACKUP C·ªïng. ![image](https://github.com/psaumur/CCNA/assets/106411237/61aefc04-b3a9-484a-bbfa-1efe792c73c7) WHICH Switch s·∫Ω be Bridge g·ªëc? What about the OTHER ports ? ![image](https://github.com/psaumur/CCNA/assets/106411237/be4d404d-829d-41ab-ba39-34e918ed7ea9) ![image](https://github.com/psaumur/CCNA/assets/106411237/b5dec396-d5fc-486b-9110-5dcc2c4dc4aa) ![image](https://github.com/psaumur/CCNA/assets/106411237/1930a17b-6c74-4756-b89d-4148008f586b) üí° RAPID STP *is* compatible v·ªõi CLASSIC STP. üí° The Giao di·ªán(S) on the RAPID STP-enabled Switch connected ƒë·∫øn the CLASSIC STP-enabled Switch s·∫Ω operate trong CLASSIC STP MODE (Timers, BLOCKING >>> LISTENING >>> LEARNING >>> FORWARDING, etc.) --- RAPID STP BPDU CLASSIC RSTP (LEFT) vs RAPID STP BPDU (RIGHT) ![image](https://github.com/psaumur/CCNA/assets/106411237/2d2deb45-3f81-4c60-b9fa-0f6c3fe7c060) üí° NOTE: Classic STP BPDU has a ‚ÄúGiao th·ª©c Version Identifier: Spanning Tree (0) BPDU Type: C·∫•u h√¨nh (0x00) BPDU flags: 0x00 RAPID STP BPDU has a ‚ÄúGiao th·ª©c Version Identifier: Spanning Tree (2) BPDU Type: C·∫•u h√¨nh (0x02) BPDU flags: 0x3c In CLASSIC STP, only the Bridge g·ªëc originated BPDUs, and other SWITCHES just FORWARDED the BPDUs they received. In RAPID STP, ALL SWITCHES originate v√† send their own BPDUs t·ª´ their DESIGNATED PORTS --- RAPID Spanning Tree Giao th·ª©c - ALL SWITCHES running RAPID STP send their own BPDUs every ‚Äúhello‚Äù time (2 Seconds) - SWITCHES ‚Äúage‚Äù the BPDU information much more quickly - In CLASSIC STP, a Switch waits 10 ‚Äúhello‚Äù intervals (20 seconds) - In RAPID STP, a Switch considers m·ªôt neighbour lost if it misses 3 BPDUs (6 seconds). It s·∫Ω then ‚Äúflush‚Äù ALL MAC ADDRESSES learned tr√™n that Giao di·ªán ![image](https://github.com/psaumur/CCNA/assets/106411237/c03d2645-42d8-4d95-b486-999e82ac12a8) --- RSTP LINK TYPES ![image](https://github.com/psaumur/CCNA/assets/106411237/e837a271-ad13-4d6a-a800-434a0eff2576) ``` <E> = EDGE <P> = POINT-TO-POINT <S> = SHARED ``` RSTP distinguishes between THREE different ‚Äúlink types‚Äù : **EDGE**, **POINT-TO-POINT**, and **SHARED** EDGE PORTS - Connected ƒë·∫øn END HOSTS - Because there l√† NO RISK c·ªßa creating m·ªôt LOOP, they c√≥ th·ªÉ move straight ƒë·∫øn the FORWARDING STATE without the negotiation process! - They function like m·ªôt CLASSIC STP C·ªïng v·ªõi PORTFAST ENABLED üí° SW1(config-if)# spanning-tree portfast --- POINT-TO-POINT PORTS - Connect directly ƒë·∫øn another Switch - They function trong FULL-DUPLEX - You don‚Äôt need ƒë·∫øn configure the Giao di·ªán as POINT-TO-POINT (it n√™n be detected) üí° SW1(config-if)# spanning-tree link-type point-to-point --- SHARED PORTS - Connect ƒë·∫øn another Switch (or SWITCHES) via m·ªôt Hub - They function trong HALF-DUPLEX - You don‚Äôt need ƒë·∫øn configure the Giao di·ªán as SHARED (it n√™n be detected) üí° SW1(config-if)# spanning-tree link-type shared --- QUIZ: ![image](https://github.com/psaumur/CCNA/assets/106411237/a7314f6f-55f0-4e62-bd24-b311b090afe8) SW1 : - **Bridge g·ªëc** - G0/0 - 0/3= DESIGNATED SW2 : - G0/0 = ROOT C·ªïng - G0/1 = DESIGNATED C·ªïng - G0/2 = BACKUP C·ªïng - G0/3 = DESIGNATED C·ªïng SW3 : - G0/0 = DESIGNATED C·ªïng - G0/1 = ALTERNATE C·ªïng - G0/2 = ROOT C·ªïng - G0/3 = DESIGNATED C·ªïng SW4: - G0/0 = ROOT - G0/1 = ALTERNATE C·ªïng - G0/2 = DESIGNATED C·ªïng Connection between SW1 G0/0 v√† SW2 G0/0 = POINT-TO-POINT Connection between SW3 G0/0 v√† SW4 G0/0 = POINT-TO-POINT Connection between SW1 G0/1 v√† G0/2 ƒë·∫øn SW3 G0/1 v√† G0/2 = POINT-TO-POINT Connections ƒë·∫øn all the END HOSTS = EDGE Connection t·ª´ SW4 ƒë·∫øn Hub = SHARED Connections t·ª´ SW2 ƒë·∫øn Hub = SHARED ANSWER ![image](https://github.com/psaumur/CCNA/assets/106411237/b76eb7be-897a-4617-990e-f399ceaea5f2) 