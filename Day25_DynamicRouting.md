# 24. DYNAMIC ĐỊNH TUYẾN là gì DYNAMIC Định tuyến? ![image](https://github.com/psaumur/CCNA/assets/106411237/8acc17ee-5d4b-4725-b5e4-18dc5743340e) - LAYER 3 - Involves configuring một DYNAMIC Định tuyến Giao thức trên the Router và letting the Router take care của finding the best routes đến DESTINATION NETWORKS. - Not Fixed (will adapt đến changes trong the LAN) ![image](https://github.com/psaumur/CCNA/assets/106411237/deb9abf6-6e21-4c94-a407-bfc501a1d739) 💡 A Mạng Tuyến đường : A Tuyến đường đến một Mạng hoặc Mạng con (Mask Length < /32) Ex: **10.0.12.0/30** and **10.0.13.0/30** (above) are Mạng ROUTES 💡 A HOST Tuyến đường : A Tuyến đường đến một specific HOST (/32 Mask) Ex: **10.0.12.1/32** and **10.0.13.1/32** (above) are HOST ROUTES These two ROUTES were AUTOMATICALLY added đến R1’s G0/0 và G1/0s INTERFACES --- HOW DYNAMIC Định tuyến WORKS ? ![image](https://github.com/psaumur/CCNA/assets/106411237/9d2d7f88-a325-461f-99fd-0dc88ee23749) (R4 ADVERTISES đến R2 who ADVERTISES đến R1 who ADVERTISES đến R3 - They add the Mạng Tuyến đường đến R4 trong their Tuyến đường TABLE) If the Mạng Tuyến đường breaks, the Tuyến đường là DYNAMICALLY REMOVED từ the Tuyến đường TABLE ![image](https://github.com/psaumur/CCNA/assets/106411237/a477d438-f6cb-4a09-b66d-e07826755bd1) (R1 removing the Tuyến đường đến R4 từ it’s Tuyến đường TABLE) IN STATIC Định tuyến, a downed Router sẽ still have traffic passed đến it. The Tuyến đường TABLES là unchanged. ![image](https://github.com/psaumur/CCNA/assets/106411237/e689a88a-7275-489c-80b4-18894a7ce4c9) (R1 has một STATIC Tuyến đường đến R4 và passes traffic destined đến it’s Mạng regardless của status) DYNAMIC Định tuyến là good but still requires REDUNDANCY so we add another connection between R3 và R4 ![image](https://github.com/psaumur/CCNA/assets/106411237/8a7cb9cb-beea-4522-87f7-7fd11df9f745) (Secondary DYNAMIC Tuyến đường added đến R4 từ R1 via R3. Tuyến đường TABLE updated appropriately) A failure trong the Tuyến đường, via R2 đến R4’s G0/0 Giao diện, automatically reroutes traffic via R3 ![image](https://github.com/psaumur/CCNA/assets/106411237/d4509ce2-07f1-4fb0-8e31-cf58c049c355) Why does the path prefer using R2’s path versus R3? Because của COST ! This là similar đến how SPANNING-TREE works (with SWITCHES) --- INTRODUCTION đến DYNAMIC Định tuyến PROTOCOLS - ROUTERS có thể use DYNAMIC Định tuyến PROTOCOLS đến ADVERTISE information about the ROUTES they know đến OTHER ROUTES - They form ‘ADJACENCIES’ / ‘NEIGHBOR RELATIONSHIPS’ / ‘NEIGHBORSHIPS’ with ADJACENT ROUTERS đến exchange this information - If multiple ROUTES đến một DESTINATION là learned, the Router determines which Tuyến đường là SUPERIOR và adds it đến the Định tuyến TABLE. It uses the ‘Metric’ of the Tuyến đường đến decide which là superior (lower Metric = superior) --- TYPES của DYNAMIC Định tuyến PROTOCOLS DYNAMIC Định tuyến PROTOCOLS có thể be divided into TWO main categories: - IGP (Interior Gateway Giao thức) - EGP (Exterior Gateway Giao thức) IGP - Used đến SHARE ROUTES within một single *autonomous system* (AS), which là một single organization (ie: a company) ![image](https://github.com/psaumur/CCNA/assets/106411237/06af6c77-3a03-44fa-8c55-9382347d3f5e) EGP - Used đến SHARE ROUTES *between* different *autonomous systems (AS)* ![image](https://github.com/psaumur/CCNA/assets/106411237/37680a4b-caab-4e1d-ac64-00a799bd965f) Algorithms used cho IGP và EGP và the Giao thức cho each ![image](https://github.com/psaumur/CCNA/assets/106411237/36729569-0e56-4eb2-91ee-e7cd25a8c234) 💡 YOU phải MEMORIZE WHICH ALGORITHM là USED cho EACH Giao thức cho THE CCNA! --- DISTANCE VECTOR Định tuyến PROTOCOLS - Called DISTANCE VECTOR because the ROUTERS only learn the ‘distance’ (Metric) and ‘vector’ (DIRECTION, NEXT-HOP Router) of each Tuyến đường - DISTANCE VECTOR PROTOCOLS were invented before LINK STATE PROTOCOLS - Early examples là RIPv1 và Cisco’s IGRP (which was updated đến EIGRP) - DISTANCES VECTOR PROTOCOLS operate bởi sending the following đến their directly connection neighbors: - Their KNOWN DESTINATION networks - Their Metric đến reach their KNOWN DESTINATION networks - This METHOD của sharing Tuyến đường information là often called ***‘Định tuyến bởi rumor’*** - ***‘Định tuyến bởi rumor’*** = because the Router doesn’t know about the Mạng beyond it’s NEIGHBOURS. It only knows the information that the NEIGHBOURS tell it. ![image](https://github.com/psaumur/CCNA/assets/106411237/773eb20d-7983-4da4-ae66-e97e421e83ba) --- DYNAMIC Định tuyến Giao thức METRICS - A Router’S Tuyến đường TABLE contains the BEST Tuyến đường đến each DESTINATION Mạng it knows about If một Router using một DYNAMIC Định tuyến Giao thức learns TWO different routes đến the same DESTINATION, how does it determine which is **‘best’** ? It uses the Metric value của the ROUTES đến determine which là BEST. A lower Metric = BETTER! (just like STP) EACH Định tuyến Giao thức uses một different Metric đến determine which Tuyến đường là best ![image](https://github.com/psaumur/CCNA/assets/106411237/bf324652-f4b8-482e-af17-03da590ac85d) The above choose the RED PATH because the “cost”, using R3 F2/0 và R4 F2/0 (FastEthernet) is HIGHER than the R2 G1/0 và R4 G0/0 (GigabyteEthernet) What if BOTH connections were GigabyteEthernet? (ie: the same Metric value) ![image](https://github.com/psaumur/CCNA/assets/106411237/3f8437cc-5b38-4f1e-b185-c5e9fce6c5f1) BOTH ROUTES là added đến the Tuyến đường TABLE So … 💡 If một Router learns TWO (or more) ROUTES via the same ****Định tuyến Giao thức đến the same DESTINATION (same Mạng Địa chỉ, same Mạng con mask) with the same Metric, both sẽ be added đến the Định tuyến table. Traffic sẽ be LOAD-BALANCED over both ROUTES ![image](https://github.com/psaumur/CCNA/assets/106411237/79662f99-a847-457b-8080-76f77c25c5e6) “O” = OSPF Giao thức (next đến ROUTES) [110/3] : - the “3” part là the Metric. - the “110” part là Khoảng cách quản trị (covered later) 💡 Since BOTH ROUTES share the same Metric, this là called ECMP (EQUAL COST MULTI-PATH) You có thể have ECMP với STATIC ROUTES, as well (they don’t use Metric, however) --- SUMMARY của DIFFERENT METRICS ![image](https://github.com/psaumur/CCNA/assets/106411237/7b8390aa-46d4-49d3-83a4-03ba095bf927) (IS-IS won’t be covered trong detail) EXAMPLE ![image](https://github.com/psaumur/CCNA/assets/106411237/d0c6c9f2-3526-46b2-b520-1f4b6b28ea8f) Using RIP, both ROUTES sẽ be put trong R1’s Tuyến đường TABLE Using OSPF, only the Tuyến đường từ R1 > R2 > R4 sẽ be added đến R1’s Tuyến đường TABLE because của the TOTAL COST của each link. However, BOTH METRICS là trying đến achieve the same thing : To let the Router select the BEST Tuyến đường đến the DESTINATION --- Khoảng cách quản trị - In MOST cases, a company sẽ only use một single IGP - usually OSPF hoặc EIGRP - However, in some RARE cases, they có thể use TWO. - Ex: If TWO companies connect their networks đến share information, TWO different Định tuyến PROTOCOLS có thể be trong use. - Metric là used đến compare ROUTES learned via the same Định tuyến Giao thức - Different Định tuyến PROTOCOLS use totally different METRICS, so they cannot be compared - An OSPF Tuyến đường đến 192.168.4.0/24 có thể have một Metric của 30, while một EIGRP Tuyến đường đến the same DESTINATION has một Metric của 33280. Which Tuyến đường là better? Which Tuyến đường nên the Router put trong the Tuyến đường TABLE ? - The **Khoảng cách quản trị (AD)**, is used đến determine which Định tuyến Giao thức là preferred. - A LOWER AD là preferred, and indicates that the Định tuyến Giao thức là considered more ‘trustworthy’ (more likely đến select good ROUTES) --- Khoảng cách quản trị NUMBERS ![image](https://github.com/psaumur/CCNA/assets/106411237/0f5ea405-d321-41bc-b2c0-2185874d07db) (USE THE FLASHCARDS đến MEMORIZE THESE) 💡 IF the Khoảng cách quản trị là 255, the Router does not believe the SOURCE của that Tuyến đường và does not install the Tuyến đường trong the Định tuyến TABLE! ![image](https://github.com/psaumur/CCNA/assets/106411237/33dbbe2b-7471-4c17-ae27-4d363d115a4c) Metric là used đến COMPARE ROUTES learned từ the SAME Định tuyến Giao thức However, before comparing METRICS, AD là used đến select the BEST Tuyến đường Therefore, the BEST Tuyến đường is : “next hop 192.168.3.1, learned via OSPF (lower AD than RIP), Metric 10” - You có thể CHANGE the AD của một Định tuyến Giao thức (This sẽ be demonstrated trong the lecture cho OSPF Cấu hình) - You có thể also change the AD của một STATIC Tuyến đường: ![image](https://github.com/psaumur/CCNA/assets/106411237/ec167f95-e5d7-49c8-aff7-1957e51934b1) ![image](https://github.com/psaumur/CCNA/assets/106411237/db6bef3b-ed82-49f0-b094-804c82f67f8d) WHY sẽ YOU WANT đến DO THIS? FLOATING STATIC ROUTES - By CHANGING the AD của một STATIC Tuyến đường, you có thể make it less preferred than ROUTES learned bởi một DYNAMIC Định tuyến Giao thức đến the same DESTINATION (make sure the AD là HIGHER than the Định tuyến Giao thức’s AD!) - This kind của Tuyến đường là called a ‘FLOATING STATIC Tuyến đường’ - The Tuyến đường sẽ be inactive (not trong the Định tuyến TABLE) unless the Tuyến đường learned bởi the DYNAMIC Định tuyến Giao thức là removed. - **Ex:** The remote Router stops ADVERTISING it cho some reason, or một Giao diện failure causes một ADJACENCY với một NEIGHBOR đến be lost. --- LINK STATE Định tuyến PROTOCOLS - When using một LINK STATE Định tuyến Giao thức, every Router creates a ‘connectivity map’ of the Mạng - To allow this, each Router ADVERTISES information about its INTERFACES (connected NETWORKS) to its NEIGHBOURS. These ADVERTISEMENTS là passed along đến the other ROUTERS, until all ROUTERS trong the Mạng develop the same map của the Mạng - Each Router independently uses this MAP đến calculate the BEST ROUTES đến each DESTINATION - LINK STATE PROTOCOLS use more resources (CPU) on the Router, because MORE information là shared. - However, LINK STATE PROTOCOLS tend đến be FASTER trong reacting đến CHANGES trong the Mạng than DISTANCES VECTOR PROTOCOLS 