# 24. DYNAMIC Äá»ŠNH TUYáº¾N lÃ  gÃ¬ DYNAMIC Äá»‹nh tuyáº¿n? ![image](https://github.com/psaumur/CCNA/assets/106411237/8acc17ee-5d4b-4725-b5e4-18dc5743340e) - LAYER 3 - Involves configuring má»™t DYNAMIC Äá»‹nh tuyáº¿n Giao thá»©c trÃªn the Router vÃ  letting the Router take care cá»§a finding the best routes Ä‘áº¿n DESTINATION NETWORKS. - Not Fixed (will adapt Ä‘áº¿n changes trong the LAN) ![image](https://github.com/psaumur/CCNA/assets/106411237/deb9abf6-6e21-4c94-a407-bfc501a1d739) ğŸ’¡ A Máº¡ng Tuyáº¿n Ä‘Æ°á»ng : A Tuyáº¿n Ä‘Æ°á»ng Ä‘áº¿n má»™t Máº¡ng hoáº·c Máº¡ng con (Mask Length < /32) Ex: **10.0.12.0/30** and **10.0.13.0/30** (above) are Máº¡ng ROUTES ğŸ’¡ A HOST Tuyáº¿n Ä‘Æ°á»ng : A Tuyáº¿n Ä‘Æ°á»ng Ä‘áº¿n má»™t specific HOST (/32 Mask) Ex: **10.0.12.1/32** and **10.0.13.1/32** (above) are HOST ROUTES These two ROUTES were AUTOMATICALLY added Ä‘áº¿n R1â€™s G0/0 vÃ  G1/0s INTERFACES --- HOW DYNAMIC Äá»‹nh tuyáº¿n WORKS ? ![image](https://github.com/psaumur/CCNA/assets/106411237/9d2d7f88-a325-461f-99fd-0dc88ee23749) (R4 ADVERTISES Ä‘áº¿n R2 who ADVERTISES Ä‘áº¿n R1 who ADVERTISES Ä‘áº¿n R3 - They add the Máº¡ng Tuyáº¿n Ä‘Æ°á»ng Ä‘áº¿n R4 trong their Tuyáº¿n Ä‘Æ°á»ng TABLE) If the Máº¡ng Tuyáº¿n Ä‘Æ°á»ng breaks, the Tuyáº¿n Ä‘Æ°á»ng lÃ  DYNAMICALLY REMOVED tá»« the Tuyáº¿n Ä‘Æ°á»ng TABLE ![image](https://github.com/psaumur/CCNA/assets/106411237/a477d438-f6cb-4a09-b66d-e07826755bd1) (R1 removing the Tuyáº¿n Ä‘Æ°á»ng Ä‘áº¿n R4 tá»« itâ€™s Tuyáº¿n Ä‘Æ°á»ng TABLE) IN STATIC Äá»‹nh tuyáº¿n, a downed Router sáº½ still have traffic passed Ä‘áº¿n it. The Tuyáº¿n Ä‘Æ°á»ng TABLES lÃ  unchanged. ![image](https://github.com/psaumur/CCNA/assets/106411237/e689a88a-7275-489c-80b4-18894a7ce4c9) (R1 has má»™t STATIC Tuyáº¿n Ä‘Æ°á»ng Ä‘áº¿n R4 vÃ  passes traffic destined Ä‘áº¿n itâ€™s Máº¡ng regardless cá»§a status) DYNAMIC Äá»‹nh tuyáº¿n lÃ  good but still requires REDUNDANCY so we add another connection between R3 vÃ  R4 ![image](https://github.com/psaumur/CCNA/assets/106411237/8a7cb9cb-beea-4522-87f7-7fd11df9f745) (Secondary DYNAMIC Tuyáº¿n Ä‘Æ°á»ng added Ä‘áº¿n R4 tá»« R1 via R3. Tuyáº¿n Ä‘Æ°á»ng TABLE updated appropriately) A failure trong the Tuyáº¿n Ä‘Æ°á»ng, via R2 Ä‘áº¿n R4â€™s G0/0 Giao diá»‡n, automatically reroutes traffic via R3 ![image](https://github.com/psaumur/CCNA/assets/106411237/d4509ce2-07f1-4fb0-8e31-cf58c049c355) Why does the path prefer using R2â€™s path versus R3? Because cá»§a COST ! This lÃ  similar Ä‘áº¿n how SPANNING-TREE works (with SWITCHES) --- INTRODUCTION Ä‘áº¿n DYNAMIC Äá»‹nh tuyáº¿n PROTOCOLS - ROUTERS cÃ³ thá»ƒ use DYNAMIC Äá»‹nh tuyáº¿n PROTOCOLS Ä‘áº¿n ADVERTISE information about the ROUTES they know Ä‘áº¿n OTHER ROUTES - They form â€˜ADJACENCIESâ€™ / â€˜NEIGHBOR RELATIONSHIPSâ€™ / â€˜NEIGHBORSHIPSâ€™ with ADJACENT ROUTERS Ä‘áº¿n exchange this information - If multiple ROUTES Ä‘áº¿n má»™t DESTINATION lÃ  learned, the Router determines which Tuyáº¿n Ä‘Æ°á»ng lÃ  SUPERIOR vÃ  adds it Ä‘áº¿n the Äá»‹nh tuyáº¿n TABLE. It uses the â€˜Metricâ€™ of the Tuyáº¿n Ä‘Æ°á»ng Ä‘áº¿n decide which lÃ  superior (lower Metric = superior) --- TYPES cá»§a DYNAMIC Äá»‹nh tuyáº¿n PROTOCOLS DYNAMIC Äá»‹nh tuyáº¿n PROTOCOLS cÃ³ thá»ƒ be divided into TWO main categories: - IGP (Interior Gateway Giao thá»©c) - EGP (Exterior Gateway Giao thá»©c) IGP - Used Ä‘áº¿n SHARE ROUTES within má»™t single *autonomous system* (AS), which lÃ  má»™t single organization (ie: a company) ![image](https://github.com/psaumur/CCNA/assets/106411237/06af6c77-3a03-44fa-8c55-9382347d3f5e) EGP - Used Ä‘áº¿n SHARE ROUTES *between* different *autonomous systems (AS)* ![image](https://github.com/psaumur/CCNA/assets/106411237/37680a4b-caab-4e1d-ac64-00a799bd965f) Algorithms used cho IGP vÃ  EGP vÃ  the Giao thá»©c cho each ![image](https://github.com/psaumur/CCNA/assets/106411237/36729569-0e56-4eb2-91ee-e7cd25a8c234) ğŸ’¡ YOU pháº£i MEMORIZE WHICH ALGORITHM lÃ  USED cho EACH Giao thá»©c cho THE CCNA! --- DISTANCE VECTOR Äá»‹nh tuyáº¿n PROTOCOLS - Called DISTANCE VECTOR because the ROUTERS only learn the â€˜distanceâ€™ (Metric) and â€˜vectorâ€™ (DIRECTION, NEXT-HOP Router) of each Tuyáº¿n Ä‘Æ°á»ng - DISTANCE VECTOR PROTOCOLS were invented before LINK STATE PROTOCOLS - Early examples lÃ  RIPv1 vÃ  Ciscoâ€™s IGRP (which was updated Ä‘áº¿n EIGRP) - DISTANCES VECTOR PROTOCOLS operate bá»Ÿi sending the following Ä‘áº¿n their directly connection neighbors: - Their KNOWN DESTINATION networks - Their Metric Ä‘áº¿n reach their KNOWN DESTINATION networks - This METHOD cá»§a sharing Tuyáº¿n Ä‘Æ°á»ng information lÃ  often called ***â€˜Äá»‹nh tuyáº¿n bá»Ÿi rumorâ€™*** - ***â€˜Äá»‹nh tuyáº¿n bá»Ÿi rumorâ€™*** = because the Router doesnâ€™t know about the Máº¡ng beyond itâ€™s NEIGHBOURS. It only knows the information that the NEIGHBOURS tell it. ![image](https://github.com/psaumur/CCNA/assets/106411237/773eb20d-7983-4da4-ae66-e97e421e83ba) --- DYNAMIC Äá»‹nh tuyáº¿n Giao thá»©c METRICS - A Routerâ€™S Tuyáº¿n Ä‘Æ°á»ng TABLE contains the BEST Tuyáº¿n Ä‘Æ°á»ng Ä‘áº¿n each DESTINATION Máº¡ng it knows about If má»™t Router using má»™t DYNAMIC Äá»‹nh tuyáº¿n Giao thá»©c learns TWO different routes Ä‘áº¿n the same DESTINATION, how does it determine which is **â€˜bestâ€™** ? It uses the Metric value cá»§a the ROUTES Ä‘áº¿n determine which lÃ  BEST. A lower Metric = BETTER! (just like STP) EACH Äá»‹nh tuyáº¿n Giao thá»©c uses má»™t different Metric Ä‘áº¿n determine which Tuyáº¿n Ä‘Æ°á»ng lÃ  best ![image](https://github.com/psaumur/CCNA/assets/106411237/bf324652-f4b8-482e-af17-03da590ac85d) The above choose the RED PATH because the â€œcostâ€, using R3 F2/0 vÃ  R4 F2/0 (FastEthernet) is HIGHER than the R2 G1/0 vÃ  R4 G0/0 (GigabyteEthernet) What if BOTH connections were GigabyteEthernet? (ie: the same Metric value) ![image](https://github.com/psaumur/CCNA/assets/106411237/3f8437cc-5b38-4f1e-b185-c5e9fce6c5f1) BOTH ROUTES lÃ  added Ä‘áº¿n the Tuyáº¿n Ä‘Æ°á»ng TABLE So â€¦ ğŸ’¡ If má»™t Router learns TWO (or more) ROUTES via the same ****Äá»‹nh tuyáº¿n Giao thá»©c Ä‘áº¿n the same DESTINATION (same Máº¡ng Äá»‹a chá»‰, same Máº¡ng con mask) with the same Metric, both sáº½ be added Ä‘áº¿n the Äá»‹nh tuyáº¿n table. Traffic sáº½ be LOAD-BALANCED over both ROUTES ![image](https://github.com/psaumur/CCNA/assets/106411237/79662f99-a847-457b-8080-76f77c25c5e6) â€œOâ€ = OSPF Giao thá»©c (next Ä‘áº¿n ROUTES) [110/3] : - the â€œ3â€ part lÃ  the Metric. - the â€œ110â€ part lÃ  Khoáº£ng cÃ¡ch quáº£n trá»‹ (covered later) ğŸ’¡ Since BOTH ROUTES share the same Metric, this lÃ  called ECMP (EQUAL COST MULTI-PATH) You cÃ³ thá»ƒ have ECMP vá»›i STATIC ROUTES, as well (they donâ€™t use Metric, however) --- SUMMARY cá»§a DIFFERENT METRICS ![image](https://github.com/psaumur/CCNA/assets/106411237/7b8390aa-46d4-49d3-83a4-03ba095bf927) (IS-IS wonâ€™t be covered trong detail) EXAMPLE ![image](https://github.com/psaumur/CCNA/assets/106411237/d0c6c9f2-3526-46b2-b520-1f4b6b28ea8f) Using RIP, both ROUTES sáº½ be put trong R1â€™s Tuyáº¿n Ä‘Æ°á»ng TABLE Using OSPF, only the Tuyáº¿n Ä‘Æ°á»ng tá»« R1 > R2 > R4 sáº½ be added Ä‘áº¿n R1â€™s Tuyáº¿n Ä‘Æ°á»ng TABLE because cá»§a the TOTAL COST cá»§a each link. However, BOTH METRICS lÃ  trying Ä‘áº¿n achieve the same thing : To let the Router select the BEST Tuyáº¿n Ä‘Æ°á»ng Ä‘áº¿n the DESTINATION --- Khoáº£ng cÃ¡ch quáº£n trá»‹ - In MOST cases, a company sáº½ only use má»™t single IGP - usually OSPF hoáº·c EIGRP - However, in some RARE cases, they cÃ³ thá»ƒ use TWO. - Ex: If TWO companies connect their networks Ä‘áº¿n share information, TWO different Äá»‹nh tuyáº¿n PROTOCOLS cÃ³ thá»ƒ be trong use. - Metric lÃ  used Ä‘áº¿n compare ROUTES learned via the same Äá»‹nh tuyáº¿n Giao thá»©c - Different Äá»‹nh tuyáº¿n PROTOCOLS use totally different METRICS, so they cannot be compared - An OSPF Tuyáº¿n Ä‘Æ°á»ng Ä‘áº¿n 192.168.4.0/24 cÃ³ thá»ƒ have má»™t Metric cá»§a 30, while má»™t EIGRP Tuyáº¿n Ä‘Æ°á»ng Ä‘áº¿n the same DESTINATION has má»™t Metric cá»§a 33280. Which Tuyáº¿n Ä‘Æ°á»ng lÃ  better? Which Tuyáº¿n Ä‘Æ°á»ng nÃªn the Router put trong the Tuyáº¿n Ä‘Æ°á»ng TABLE ? - The **Khoáº£ng cÃ¡ch quáº£n trá»‹ (AD)**, is used Ä‘áº¿n determine which Äá»‹nh tuyáº¿n Giao thá»©c lÃ  preferred. - A LOWER AD lÃ  preferred, and indicates that the Äá»‹nh tuyáº¿n Giao thá»©c lÃ  considered more â€˜trustworthyâ€™ (more likely Ä‘áº¿n select good ROUTES) --- Khoáº£ng cÃ¡ch quáº£n trá»‹ NUMBERS ![image](https://github.com/psaumur/CCNA/assets/106411237/0f5ea405-d321-41bc-b2c0-2185874d07db) (USE THE FLASHCARDS Ä‘áº¿n MEMORIZE THESE) ğŸ’¡ IF the Khoáº£ng cÃ¡ch quáº£n trá»‹ lÃ  255, the Router does not believe the SOURCE cá»§a that Tuyáº¿n Ä‘Æ°á»ng vÃ  does not install the Tuyáº¿n Ä‘Æ°á»ng trong the Äá»‹nh tuyáº¿n TABLE! ![image](https://github.com/psaumur/CCNA/assets/106411237/33dbbe2b-7471-4c17-ae27-4d363d115a4c) Metric lÃ  used Ä‘áº¿n COMPARE ROUTES learned tá»« the SAME Äá»‹nh tuyáº¿n Giao thá»©c However, before comparing METRICS, AD lÃ  used Ä‘áº¿n select the BEST Tuyáº¿n Ä‘Æ°á»ng Therefore, the BEST Tuyáº¿n Ä‘Æ°á»ng is : â€œnext hop 192.168.3.1, learned via OSPF (lower AD than RIP), Metric 10â€ - You cÃ³ thá»ƒ CHANGE the AD cá»§a má»™t Äá»‹nh tuyáº¿n Giao thá»©c (This sáº½ be demonstrated trong the lecture cho OSPF Cáº¥u hÃ¬nh) - You cÃ³ thá»ƒ also change the AD cá»§a má»™t STATIC Tuyáº¿n Ä‘Æ°á»ng: ![image](https://github.com/psaumur/CCNA/assets/106411237/ec167f95-e5d7-49c8-aff7-1957e51934b1) ![image](https://github.com/psaumur/CCNA/assets/106411237/db6bef3b-ed82-49f0-b094-804c82f67f8d) WHY sáº½ YOU WANT Ä‘áº¿n DO THIS? FLOATING STATIC ROUTES - By CHANGING the AD cá»§a má»™t STATIC Tuyáº¿n Ä‘Æ°á»ng, you cÃ³ thá»ƒ make it less preferred than ROUTES learned bá»Ÿi má»™t DYNAMIC Äá»‹nh tuyáº¿n Giao thá»©c Ä‘áº¿n the same DESTINATION (make sure the AD lÃ  HIGHER than the Äá»‹nh tuyáº¿n Giao thá»©câ€™s AD!) - This kind cá»§a Tuyáº¿n Ä‘Æ°á»ng lÃ  called a â€˜FLOATING STATIC Tuyáº¿n Ä‘Æ°á»ngâ€™ - The Tuyáº¿n Ä‘Æ°á»ng sáº½ be inactive (not trong the Äá»‹nh tuyáº¿n TABLE) unless the Tuyáº¿n Ä‘Æ°á»ng learned bá»Ÿi the DYNAMIC Äá»‹nh tuyáº¿n Giao thá»©c lÃ  removed. - **Ex:** The remote Router stops ADVERTISING it cho some reason, or má»™t Giao diá»‡n failure causes má»™t ADJACENCY vá»›i má»™t NEIGHBOR Ä‘áº¿n be lost. --- LINK STATE Äá»‹nh tuyáº¿n PROTOCOLS - When using má»™t LINK STATE Äá»‹nh tuyáº¿n Giao thá»©c, every Router creates a â€˜connectivity mapâ€™ of the Máº¡ng - To allow this, each Router ADVERTISES information about its INTERFACES (connected NETWORKS) to its NEIGHBOURS. These ADVERTISEMENTS lÃ  passed along Ä‘áº¿n the other ROUTERS, until all ROUTERS trong the Máº¡ng develop the same map cá»§a the Máº¡ng - Each Router independently uses this MAP Ä‘áº¿n calculate the BEST ROUTES Ä‘áº¿n each DESTINATION - LINK STATE PROTOCOLS use more resources (CPU) on the Router, because MORE information lÃ  shared. - However, LINK STATE PROTOCOLS tend Ä‘áº¿n be FASTER trong reacting Ä‘áº¿n CHANGES trong the Máº¡ng than DISTANCES VECTOR PROTOCOLS 